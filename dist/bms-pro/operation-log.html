<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>操作日志 - AlwaysControl</title>
    <style>
        /* ===== 全局重置 ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* 主题色系 */
            --primary-blue: #1E6BFF;
            --hover-blue: #4589FF;
            --light-blue: #E8F3FF;
            --success-green: #52C41A;
            --warning-orange: #FA8C16;
            --error-red: #F5222D;
            --text-dark: #333333;
            --text-gray: #666666;
            --text-light: #999999;
            --border-color: #E5E7EB;
            --bg-white: #FFFFFF;
            --bg-gray: #F8F9FA;
            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.08);
            --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.12);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB',
                         'Microsoft YaHei', 'Helvetica Neue', Helvetica, Arial, sans-serif;
            background: var(--bg-gray);
            min-height: 100vh;
            line-height: 1.6;
        }

        /* ===== 顶部导航栏 ===== */
        .top-navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: var(--bg-white);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 24px;
            z-index: 1000;
            box-shadow: var(--shadow-sm);
        }

        .navbar-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .brand-logo {
            font-size: 20px;
            font-weight: 600;
            color: var(--primary-blue);
            cursor: pointer;
        }

        .navbar-right {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .icon-btn {
            width: 36px;
            height: 36px;
            border: none;
            background: transparent;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            position: relative;
        }

        .icon-btn:hover {
            background: var(--bg-gray);
        }

        .icon-btn svg {
            width: 20px;
            height: 20px;
            fill: var(--text-gray);
        }

        .icon-btn.has-badge::after {
            content: '';
            position: absolute;
            top: 8px;
            right: 8px;
            width: 8px;
            height: 8px;
            background: var(--error-red);
            border-radius: 50%;
            border: 2px solid var(--bg-white);
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 6px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        .user-menu:hover {
            background: var(--bg-gray);
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-blue), var(--hover-blue));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
            font-weight: 600;
        }

        .user-name {
            font-size: 14px;
            color: var(--text-dark);
            font-weight: 500;
        }

        .dropdown-icon {
            width: 16px;
            height: 16px;
            fill: var(--text-gray);
            transition: transform 0.2s;
        }

        .user-menu.active .dropdown-icon {
            transform: rotate(180deg);
        }

        .user-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 8px;
            background: var(--bg-white);
            border-radius: 8px;
            box-shadow: var(--shadow-md);
            min-width: 180px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s;
        }

        .user-menu.active .user-dropdown {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .dropdown-item {
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: background 0.2s;
            font-size: 14px;
            color: var(--text-dark);
            border-bottom: 1px solid var(--border-color);
        }

        .dropdown-item:last-child {
            border-bottom: none;
            color: var(--error-red);
        }

        .dropdown-item:hover {
            background: var(--bg-gray);
        }

        .dropdown-item svg {
            width: 18px;
            height: 18px;
            fill: currentColor;
        }

        /* ===== 侧边栏 ===== */
        .sidebar {
            position: fixed;
            top: 60px;
            left: 0;
            bottom: 0;
            width: 240px;
            background: var(--bg-white);
            border-right: 1px solid var(--border-color);
            padding: 16px 0;
            overflow-y: auto;
            z-index: 999;
        }

        .menu-group {
            margin-bottom: 8px;
        }

        .menu-parent {
            padding: 12px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            transition: all 0.2s;
            color: var(--text-dark);
            font-size: 14px;
            font-weight: 500;
        }

        .menu-parent:hover {
            background: var(--bg-gray);
        }

        .menu-parent.active {
            background: var(--light-blue);
            color: var(--primary-blue);
        }

        .menu-parent-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .menu-parent-left svg {
            width: 20px;
            height: 20px;
            fill: currentColor;
        }

        .menu-arrow {
            width: 16px;
            height: 16px;
            fill: var(--text-gray);
            transition: transform 0.3s;
        }

        .menu-parent.expanded .menu-arrow {
            transform: rotate(90deg);
        }

        .menu-children {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .menu-children.show {
            max-height: 300px;
        }

        .menu-child {
            padding: 10px 20px 10px 52px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: all 0.2s;
            color: var(--text-gray);
            font-size: 14px;
        }

        .menu-child:hover {
            background: var(--bg-gray);
            color: var(--text-dark);
        }

        .menu-child.active {
            background: var(--light-blue);
            color: var(--primary-blue);
            font-weight: 500;
        }

        .menu-child svg {
            width: 16px;
            height: 16px;
            fill: currentColor;
        }

        /* ===== 主内容区 ===== */
        .main-content {
            margin-left: 240px;
            margin-top: 60px;
            padding: 24px;
            min-height: calc(100vh - 60px);
        }

        .page-header {
            margin-bottom: 24px;
        }

        .page-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--text-dark);
        }

        /* ===== 内容卡片 ===== */
        .content-card {
            background: var(--bg-white);
            border-radius: 8px;
            box-shadow: var(--shadow-sm);
            padding: 24px;
        }

        /* ===== 筛选区域 ===== */
        .filter-section {
            display: flex;
            gap: 16px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .filter-label {
            font-size: 13px;
            color: var(--text-gray);
            font-weight: 500;
        }

        .filter-input-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }

        .search-input {
            width: 280px;
            height: 36px;
            padding: 0 12px 0 36px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 14px;
            outline: none;
            transition: all 0.2s;
        }

        .search-input:focus {
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(30, 107, 255, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 12px;
            width: 16px;
            height: 16px;
            fill: var(--text-light);
        }

        .filter-select {
            width: 180px;
            height: 36px;
            padding: 0 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 14px;
            outline: none;
            cursor: pointer;
            background: var(--bg-white);
        }

        .filter-select:focus {
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(30, 107, 255, 0.1);
        }

        .date-input {
            width: 150px;
            height: 36px;
            padding: 0 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 14px;
            outline: none;
            cursor: pointer;
        }

        .date-input:focus {
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(30, 107, 255, 0.1);
        }

        .filter-actions {
            display: flex;
            gap: 12px;
            align-items: flex-end;
        }

        .btn {
            height: 36px;
            padding: 0 20px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s;
            font-weight: 500;
        }

        .btn-primary {
            background: var(--primary-blue);
            color: white;
        }

        .btn-primary:hover {
            background: var(--hover-blue);
        }

        .btn-default {
            background: var(--bg-white);
            color: var(--text-dark);
            border: 1px solid var(--border-color);
        }

        .btn-default:hover {
            border-color: var(--primary-blue);
            color: var(--primary-blue);
        }

        .btn svg {
            width: 16px;
            height: 16px;
            fill: currentColor;
        }

        /* ===== 操作区域 ===== */
        .action-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        /* ===== 表格样式 ===== */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        .data-table thead tr {
            background: var(--bg-gray);
        }

        .data-table th {
            padding: 12px 16px;
            text-align: left;
            font-size: 13px;
            font-weight: 600;
            color: var(--text-dark);
            border-bottom: 1px solid var(--border-color);
        }

        .data-table td {
            padding: 12px 16px;
            font-size: 14px;
            color: var(--text-gray);
            border-bottom: 1px solid var(--border-color);
        }

        .data-table tbody tr:hover {
            background: var(--bg-gray);
        }

        .data-table input[type="checkbox"] {
            width: 16px;
            height: 16px;
            cursor: pointer;
        }

        /* ===== 标签样式 ===== */
        .tag {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }

        .tag-modify {
            background: #E6F7FF;
            color: #1890FF;
        }

        .tag-add {
            background: #F6FFED;
            color: #52C41A;
        }

        .tag-delete {
            background: #FFF1F0;
            color: #F5222D;
        }

        .tag-upgrade {
            background: #FFF7E6;
            color: #FA8C16;
        }

        /* ===== 分页 ===== */
        .pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
        }

        .pagination-info {
            font-size: 14px;
            color: var(--text-gray);
        }

        .pagination-controls {
            display: flex;
            gap: 8px;
        }

        .page-btn {
            width: 32px;
            height: 32px;
            border: 1px solid var(--border-color);
            background: var(--bg-white);
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .page-btn:hover {
            border-color: var(--primary-blue);
            color: var(--primary-blue);
        }

        .page-btn.active {
            background: var(--primary-blue);
            color: white;
            border-color: var(--primary-blue);
        }

        .page-btn svg {
            width: 14px;
            height: 14px;
            fill: currentColor;
        }
    </style>
</head>
<body>
    <!-- 顶部导航栏 -->
    <nav class="top-navbar">
        <div class="navbar-left">
            <div class="brand-logo">
                <img src="logo.png" alt="AlwaysControl Technology" style="height: 40px; object-fit: contain;">
            </div>
        </div>
        <div class="navbar-right">
            <!-- 夜间模式 -->
            <button class="icon-btn" title="夜间模式" onclick="toggleTheme()">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69zM12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6zm0-10c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4z"/>
                </svg>
            </button>
            <!-- 语言切换 -->
            <button class="icon-btn" title="语言切换" onclick="toggleLanguage()">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/>
                </svg>
            </button>
            <!-- 铃铛按钮 -->
            <button class="icon-btn has-badge" title="告警通知" onclick="window.location.href='alarm-management.html'">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2zm-2 1H8v-6c0-2.48 1.51-4.5 4-4.5s4 2.02 4 4.5v6z"/>
                </svg>
            </button>
            <!-- 用户菜单 -->
            <div class="user-menu" onclick="toggleUserMenu()">
                <div class="user-avatar">管</div>
                <span class="user-name">管理员</span>
                <svg class="dropdown-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M7 10l5 5 5-5z"/>
                </svg>
                <div class="user-dropdown">
                    <div class="dropdown-item">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/>
                        </svg>
                        账号设置
                    </div>
                    <div class="dropdown-item" onclick="logout()">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"/>
                        </svg>
                        退出登录
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- 左侧菜单栏 -->
    <aside class="sidebar">
        <!-- 用户管理菜单组 -->
        <div class="menu-group">
            <div class="menu-parent" onclick="toggleMenu(this)">
                <div class="menu-parent-left">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                    </svg>
                    <span>用户管理</span>
                </div>
                <svg class="menu-arrow" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
                </svg>
            </div>
            <div class="menu-children">
                <div class="menu-child" onclick="window.location.href='user-management.html'">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                    </svg>
                    <span>用户管理</span>
                </div>
                <div class="menu-child" onclick="window.location.href='distributor-management.html'">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"/>
                    </svg>
                    <span>分销商管理</span>
                </div>
            </div>
        </div>

        <!-- 设备管理菜单组 -->
        <div class="menu-group">
            <div class="menu-parent expanded active" onclick="toggleMenu(this)">
                <div class="menu-parent-left">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M20 2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM8 20H4v-4h4v4zm0-6H4v-4h4v4zm0-6H4V4h4v4zm6 12h-4v-4h4v4zm0-6h-4v-4h4v4zm0-6h-4V4h4v4zm6 12h-4v-4h4v4zm0-6h-4v-4h4v4zm0-6h-4V4h4v4z"/>
                    </svg>
                    <span>设备管理</span>
                </div>
                <svg class="menu-arrow" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
                </svg>
            </div>
            <div class="menu-children show">
                <div class="menu-child" onclick="window.location.href='device-management.html'">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M4 6h16v2H4zm0 5h16v2H4zm0 5h16v2H4z"/>
                    </svg>
                    <span>设备管理</span>
                </div>
                <div class="menu-child" onclick="window.location.href='alarm-management.html'">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/>
                    </svg>
                    <span>告警管理</span>
                </div>
            </div>
        </div>

        <!-- 系统管理菜单组 -->
        <div class="menu-group">
            <div class="menu-parent expanded active" onclick="toggleMenu(this)">
                <div class="menu-parent-left">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/>
                    </svg>
                    <span>系统管理</span>
                </div>
                <svg class="menu-arrow" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
                </svg>
            </div>
            <div class="menu-children show">
                <div class="menu-child" onclick="window.location.href='role-management.html'">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/>
                    </svg>
                    <span>角色管理</span>
                </div>
                <div class="menu-child" onclick="window.location.href='personnel-management.html'">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/>
                    </svg>
                    <span>人员管理</span>
                </div>
                <div class="menu-child active">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
                    </svg>
                    <span>操作日志</span>
                </div>
            </div>
        </div>
    </aside>

    <!-- 主内容区 -->
    <main class="main-content">
        <div class="page-header">
            <h1 class="page-title">操作日志</h1>
        </div>

        <div class="content-card">
            <!-- 筛选区域 -->
            <div class="filter-section">
                <div class="filter-item">
                    <label class="filter-label">关键词搜索</label>
                    <div class="filter-input-wrapper">
                        <svg class="search-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
                        </svg>
                        <input type="text" class="search-input" placeholder="搜索操作内容" id="searchInput">
                    </div>
                </div>

                <div class="filter-item">
                    <label class="filter-label">操作类型</label>
                    <select class="filter-select" id="operationType">
                        <option value="all">全部</option>
                        <option value="modify">修改指令</option>
                        <option value="add">添加</option>
                        <option value="delete">删除</option>
                        <option value="upgrade">升级</option>
                    </select>
                </div>

                <div class="filter-item">
                    <label class="filter-label">日期范围</label>
                    <div style="display: flex; gap: 8px; align-items: center;">
                        <input type="date" class="date-input" id="startDate">
                        <span style="color: var(--text-light);">-</span>
                        <input type="date" class="date-input" id="endDate">
                    </div>
                </div>

                <div class="filter-actions">
                    <button class="btn btn-primary" onclick="applyFilters()">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
                        </svg>
                        查询
                    </button>
                    <button class="btn btn-default" onclick="resetFilters()">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
                        </svg>
                        重置
                    </button>
                </div>
            </div>

            <!-- 操作区域 -->
            <div class="action-bar">
                <button class="btn btn-primary" onclick="exportLogs()">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z"/>
                    </svg>
                    导出
                </button>
            </div>

            <!-- 表格 -->
            <table class="data-table">
                <thead>
                    <tr>
                        <th><input type="checkbox" onclick="toggleAllCheckboxes(this)"></th>
                        <th>设备ID</th>
                        <th>操作模块</th>
                        <th>操作类型</th>
                        <th>操作内容</th>
                        <th>操作人</th>
                        <th>操作时间</th>
                    </tr>
                </thead>
                <tbody id="logTableBody">
                    <!-- 数据行动态填充 -->
                </tbody>
            </table>

            <!-- 分页 -->
            <div class="pagination">
                <div class="pagination-info">显示 1-10 条，共 28 条</div>
                <div class="pagination-controls">
                    <button class="page-btn">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
                        </svg>
                    </button>
                    <button class="page-btn active">1</button>
                    <button class="page-btn">2</button>
                    <button class="page-btn">3</button>
                    <button class="page-btn">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </main>

    <script>
        // 模拟操作日志数据
        const mockLogs = [
            {
                id: 1,
                deviceId: 'BMS001',
                module: '设备管理',
                type: 'modify',
                typeName: '修改指令',
                content: '修改设备充电参数：最大充电电流从80A调整为100A',
                operator: '管理员',
                operateTime: '2025-10-29 14:32:15'
            },
            {
                id: 2,
                deviceId: 'BMS002',
                module: '告警管理',
                type: 'add',
                typeName: '添加',
                content: '添加新的告警规则：SOC低于10%触发严重告警',
                operator: '管理员',
                operateTime: '2025-10-29 13:18:42'
            },
            {
                id: 3,
                deviceId: 'BMS003',
                module: '设备管理',
                type: 'delete',
                typeName: '删除',
                content: '删除离线设备BMS-C区-01',
                operator: '管理员',
                operateTime: '2025-10-29 11:25:33'
            },
            {
                id: 4,
                deviceId: 'BMS004',
                module: '设备管理',
                type: 'upgrade',
                typeName: '升级',
                content: 'OTA固件升级：版本v1.2.3升级至v1.2.4',
                operator: '管理员',
                operateTime: '2025-10-29 10:45:18'
            },
            {
                id: 5,
                deviceId: 'BMS005',
                module: '保护参数',
                type: 'modify',
                typeName: '修改指令',
                content: '修改一级保护参数：过压告警值从3600mV调整为3650mV',
                operator: '管理员',
                operateTime: '2025-10-29 09:52:07'
            },
            {
                id: 6,
                deviceId: 'BMS006',
                module: '设备管理',
                type: 'add',
                typeName: '添加',
                content: '新增设备BMS-F区-03',
                operator: '管理员',
                operateTime: '2025-10-28 16:38:29'
            },
            {
                id: 7,
                deviceId: 'BMS007',
                module: '逆变器参数',
                type: 'modify',
                typeName: '修改指令',
                content: '修改逆变器通信协议：CANBUS从Pylon切换为Growatt',
                operator: '管理员',
                operateTime: '2025-10-28 15:22:51'
            },
            {
                id: 8,
                deviceId: 'BMS008',
                module: '告警管理',
                type: 'modify',
                typeName: '修改指令',
                content: '标记告警ALM005为已解决状态',
                operator: '管理员',
                operateTime: '2025-10-28 14:10:44'
            },
            {
                id: 9,
                deviceId: 'BMS009',
                module: '设备管理',
                type: 'upgrade',
                typeName: '升级',
                content: '批量OTA升级：5台设备从v1.2.2升级至v1.2.3',
                operator: '管理员',
                operateTime: '2025-10-28 10:05:33'
            },
            {
                id: 10,
                deviceId: 'BMS010',
                module: '保护参数',
                type: 'modify',
                typeName: '修改指令',
                content: '导出一级(MCU)保护参数配置',
                operator: '管理员',
                operateTime: '2025-10-27 17:48:16'
            }
        ];

        // 渲染表格
        function renderTable(data = mockLogs) {
            const tbody = document.getElementById('logTableBody');
            tbody.innerHTML = '';

            data.forEach(log => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><input type="checkbox" class="row-checkbox"></td>
                    <td>${log.deviceId}</td>
                    <td>${log.module}</td>
                    <td><span class="tag tag-${log.type}">${log.typeName}</span></td>
                    <td>${log.content}</td>
                    <td>${log.operator}</td>
                    <td>${log.operateTime}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        // 全选/取消全选
        function toggleAllCheckboxes(checkbox) {
            const checkboxes = document.querySelectorAll('.row-checkbox');
            checkboxes.forEach(cb => cb.checked = checkbox.checked);
        }

        // 应用筛选
        function applyFilters() {
            const keyword = document.getElementById('searchInput').value.toLowerCase();
            const type = document.getElementById('operationType').value;
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;

            let filtered = mockLogs;

            // 关键词筛选
            if (keyword) {
                filtered = filtered.filter(log =>
                    log.content.toLowerCase().includes(keyword) ||
                    log.module.toLowerCase().includes(keyword)
                );
            }

            // 类型筛选
            if (type !== 'all') {
                filtered = filtered.filter(log => log.type === type);
            }

            // 日期筛选
            if (startDate && endDate) {
                filtered = filtered.filter(log => {
                    const logDate = log.operateTime.split(' ')[0];
                    return logDate >= startDate && logDate <= endDate;
                });
            }

            renderTable(filtered);
        }

        // 重置筛选
        function resetFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('operationType').value = 'all';
            document.getElementById('startDate').value = '';
            document.getElementById('endDate').value = '';
            renderTable(mockLogs);
        }

        // 导出日志
        function exportLogs() {
            const checkedBoxes = document.querySelectorAll('.row-checkbox:checked');
            if (checkedBoxes.length === 0) {
                alert('请先选择要导出的日志');
                return;
            }

            // 构建CSV内容
            let csvContent = '设备ID,操作模块,操作类型,操作内容,操作人,操作时间\n';

            checkedBoxes.forEach((checkbox, index) => {
                const row = checkbox.closest('tr');
                const cells = row.querySelectorAll('td');
                const rowData = [
                    cells[1].textContent,
                    cells[2].textContent,
                    cells[3].textContent.trim(),
                    cells[4].textContent,
                    cells[5].textContent,
                    cells[6].textContent
                ].join(',');
                csvContent += rowData + '\n';
            });

            // 创建下载
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            const timestamp = new Date().toISOString().slice(0, 10);

            link.setAttribute('href', url);
            link.setAttribute('download', `操作日志_${timestamp}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);

            alert('操作日志导出成功！');
        }

        // 页面加载时渲染表格
        document.addEventListener('DOMContentLoaded', function() {
            renderTable();
        });

        // ===== 菜单交互 =====
        function toggleMenu(element) {
            const isExpanded = element.classList.contains('expanded');
            const children = element.nextElementSibling;

            if (isExpanded) {
                element.classList.remove('expanded');
                children.classList.remove('show');
            } else {
                element.classList.add('expanded');
                children.classList.add('show');
            }
        }

        // ===== 夜间模式切换 =====
        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            const sunIcon = document.getElementById('sunIcon');
            const moonIcon = document.getElementById('moonIcon');
            if (document.body.classList.contains('dark-mode')) {
                if (sunIcon) sunIcon.style.display = 'none';
                if (moonIcon) moonIcon.style.display = 'block';
            } else {
                if (sunIcon) sunIcon.style.display = 'block';
                if (moonIcon) moonIcon.style.display = 'none';
            }
        }

        // ===== 语言切换 =====
        function toggleLanguage() {
            alert('语言切换功能 - 实际项目中会切换语言');
        }

        // ===== 用户菜单切换 =====
        function toggleUserMenu() {
            const userMenu = document.querySelector('.user-menu');
            if (userMenu) {
                userMenu.classList.toggle('active');
            }
        }

        // ===== 退出登录 =====
        function logout() {
            if (confirm('确定要退出登录吗?')) {
                alert('已退出登录');
                window.location.href = 'index.html';
            }
        }
    </script>
</body>
</html>
