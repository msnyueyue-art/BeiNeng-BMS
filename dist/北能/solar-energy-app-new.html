<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŒ—èƒ½æ™ºèƒ½å…‰ä¼ç®¡ç†ç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'PingFang SC', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #1d1d1f;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 40px 20px;
        }
        
        /* iPhone 13 æ‰‹æœºå¤–å£³ */
        .phone-container {
            width: 390px;
            height: 844px;
            background: #ffffff;
            border-radius: 47px;
            position: relative;
            overflow: hidden;
            /* æ‰‹æœºå¤–å£³è¾¹æ¡† */
            border: 4px solid #1d1d1f;
            /* 3Dç«‹ä½“æ•ˆæœé˜´å½± */
            box-shadow: 
                /* ä¸»è¦é˜´å½± */
                0 30px 80px rgba(0, 0, 0, 0.25),
                0 15px 40px rgba(0, 0, 0, 0.15),
                /* è¾¹æ¡†å†…é˜´å½± */
                inset 0 1px 0 rgba(255, 255, 255, 0.1),
                inset 0 -1px 0 rgba(0, 0, 0, 0.1),
                /* ä¾§è¾¹é«˜å…‰ */
                -2px 0 0 rgba(255, 255, 255, 0.05),
                2px 0 0 rgba(0, 0, 0, 0.1);
            /* 3Då˜æ¢ */
            transform: perspective(1000px) rotateX(-5deg) rotateY(2deg);
            transition: all 0.3s ease;
        }
        
        .phone-container:hover {
            transform: perspective(1000px) rotateX(-2deg) rotateY(1deg) scale(1.02);
            box-shadow: 
                0 40px 100px rgba(0, 0, 0, 0.3),
                0 20px 50px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.15),
                inset 0 -1px 0 rgba(0, 0, 0, 0.15),
                -3px 0 0 rgba(255, 255, 255, 0.08),
                3px 0 0 rgba(0, 0, 0, 0.15);
        }
        
        /* æ‰‹æœºå¤–å£³æè´¨çº¹ç† */
        .phone-container::before {
            content: '';
            position: absolute;
            top: -4px;
            left: -4px;
            right: -4px;
            bottom: -4px;
            background: linear-gradient(135deg, 
                #2c3e50 0%,
                #34495e 25%,
                #2c3e50 50%,
                #1a252f 75%,
                #0f1419 100%);
            border-radius: 51px;
            z-index: -1;
            /* é‡‘å±è´¨æ„Ÿ */
            background-image: 
                linear-gradient(45deg, transparent 40%, rgba(255,255,255,0.1) 50%, transparent 60%),
                radial-gradient(circle at 30% 30%, rgba(255,255,255,0.05) 0%, transparent 50%);
        }
        
        /* ä¾§è¾¹æŒ‰é’® */
        .phone-container::after {
            content: '';
            position: absolute;
            left: -6px;
            top: 180px;
            width: 6px;
            height: 60px;
            background: linear-gradient(180deg, #34495e, #2c3e50, #1a252f);
            border-radius: 3px 0 0 3px;
            box-shadow: inset 1px 0 0 rgba(255,255,255,0.1);
        }
        
        /* çŠ¶æ€æ  */
        .status-bar {
            height: 47px;
            padding: 0 30px;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            font-size: 17px;
            font-weight: 600;
            color: #1d1d1f;
            background: transparent;
            padding-bottom: 6px;
            position: relative;
            z-index: 10;
        }
        
        /* åˆ˜æµ·è®¾è®¡ */
        .notch {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 210px;
            height: 30px;
            background: #000000;
            border-radius: 0 0 20px 20px;
            z-index: 100;
        }
        
        .status-icons {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        
        .battery {
            width: 24px;
            height: 12px;
            border: 1px solid #1f2937;
            border-radius: 2px;
            position: relative;
        }
        
        .battery::after {
            content: '';
            position: absolute;
            right: -3px;
            top: 3px;
            width: 2px;
            height: 6px;
            background: #1f2937;
            border-radius: 0 1px 1px 0;
        }
        
        .battery-level {
            width: 70%;
            height: 8px;
            background: #1f2937;
            border-radius: 1px;
            margin: 1px;
        }
        
        /* ä¸»å†…å®¹åŒº */
        .main-content {
            height: calc(100% - 47px - 88px);
            padding: 0 24px 8px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            position: relative;
            z-index: 5;
        }
        
        /* é¡µé¢å¤´éƒ¨ - è‹¹æœé£æ ¼ */
        .page-header {
            margin-bottom: 24px;
            flex-shrink: 0;
        }
        
        .page-title {
            font-size: 40px;
            font-weight: 700;
            color: #1d1d1f;
            margin-bottom: 4px;
            letter-spacing: -1px;
            line-height: 1.05;
        }
        
        .page-subtitle {
            font-size: 19px;
            color: #86868b;
            font-weight: 400;
            margin-bottom: 0;
        }
        
        /* èƒ½æºå¡ç‰‡ - æç®€è‹¹æœé£æ ¼ */
        .energy-cards {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-bottom: 24px;
            flex-shrink: 0;
        }
        
        .energy-card {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 20px;
            border: 0.5px solid rgba(0, 0, 0, 0.04);
            padding: 20px 16px;
            text-align: center;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .energy-card:active {
            transform: scale(0.97);
            background: rgba(255, 255, 255, 0.6);
        }
        
        .energy-value {
            font-size: 28px;
            font-weight: 700;
            color: #1d1d1f;
            margin-bottom: 4px;
            font-variant-numeric: tabular-nums;
        }
        
        .energy-unit {
            font-size: 14px;
            color: #86868b;
            font-weight: 500;
        }
        
        .energy-label {
            font-size: 13px;
            color: #86868b;
            margin-top: 8px;
            font-weight: 400;
            letter-spacing: 0.2px;
        }
        
        /* çŠ¶æ€å¡ç‰‡ - æç®€è‹¹æœé£æ ¼ */
        .status-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(30px);
            -webkit-backdrop-filter: blur(30px);
            border-radius: 24px;
            border: 0.5px solid rgba(0, 0, 0, 0.04);
            padding: 28px 24px;
            margin-bottom: 24px;
            flex-shrink: 0;
        }
        
        .status-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .status-title {
            font-size: 22px;
            font-weight: 600;
            color: #1d1d1f;
            letter-spacing: -0.2px;
        }
        
        .status-mode {
            font-size: 15px;
            color: #30d158;
            font-weight: 600;
        }
        
        .current-status {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 16px 0;
        }
        
        .status-icon {
            font-size: 44px;
            margin-right: 16px;
            opacity: 0.9;
        }
        
        .status-info {
            flex: 1;
        }
        
        .power-reading {
            font-size: 36px;
            font-weight: 700;
            color: #1d1d1f;
            font-variant-numeric: tabular-nums;
            margin-bottom: 4px;
            letter-spacing: -0.5px;
        }
        
        .power-label {
            font-size: 17px;
            color: #86868b;
            font-weight: 500;
        }
        
        /* æç®€æ•°æ®ç½‘æ ¼ */
        .summary-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            flex: 1;
        }
        
        .summary-item {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 0.5px solid rgba(0, 0, 0, 0.04);
            border-radius: 18px;
            padding: 20px 16px;
            text-align: center;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .summary-item:active {
            transform: scale(0.97);
            background: rgba(255, 255, 255, 0.5);
        }
        
        .summary-value {
            font-size: 24px;
            font-weight: 700;
            color: #1d1d1f;
            margin-bottom: 6px;
            font-variant-numeric: tabular-nums;
        }
        
        .summary-label {
            font-size: 12px;
            color: #86868b;
            font-weight: 400;
            letter-spacing: 0.2px;
        }
        
        /* åº•éƒ¨å¯¼èˆªæ  - æç®€è‹¹æœé£æ ¼ */
        .bottom-navigation {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 88px;
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(30px);
            -webkit-backdrop-filter: blur(30px);
            border-top: 0.33px solid rgba(0, 0, 0, 0.08);
            display: flex;
            justify-content: space-around;
            align-items: flex-start;
            padding-top: 8px;
            padding-bottom: 34px;
            z-index: 10;
        }
        
        /* Home Indicator - ç²¾ç»†è®¾è®¡ */
        .home-indicator {
            position: absolute;
            bottom: 8px;
            left: 50%;
            transform: translateX(-50%);
            width: 134px;
            height: 5px;
            background: #1d1d1f;
            border-radius: 2.5px;
            opacity: 0.4;
            box-shadow: 
                inset 0 1px 0 rgba(255, 255, 255, 0.1),
                0 1px 2px rgba(0, 0, 0, 0.1);
        }
        
        .nav-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            cursor: pointer;
            padding: 4px 8px;
            transition: opacity 0.2s ease;
            position: relative;
        }
        
        .nav-icon {
            width: 26px;
            height: 26px;
            margin-bottom: 3px;
            transition: all 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .nav-label {
            font-size: 10px;
            font-weight: 500;
            transition: all 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            line-height: 1.1;
            letter-spacing: 0.1px;
        }
        
        .nav-item.active .nav-icon {
            color: #007aff;
            transform: translateY(-1px);
        }
        
        .nav-item.active .nav-label {
            color: #007aff;
        }
        
        .nav-item:not(.active) .nav-icon {
            color: #86868b;
        }
        
        .nav-item:not(.active) .nav-label {
            color: #86868b;
        }
        
        .nav-item:active {
            opacity: 0.6;
        }
        
        /* é¡µé¢åˆ‡æ¢ */
        .page-content {
            display: none;
        }
        
        .page-content.active {
            display: block;
        }
        
        /* æ‰‹æœºå¤–å£³çš„ç²¾ç»†è£…é¥° */
        .phone-container .screen-protector {
            position: absolute;
            top: 2px;
            left: 2px;
            right: 2px;
            bottom: 2px;
            background: transparent;
            border-radius: 45px;
            pointer-events: none;
            z-index: 1;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        /* å“åº”å¼ */
        @media (max-width: 400px) {
            body {
                padding: 20px 10px;
            }
            
            .phone-container {
                width: 100%;
                max-width: 390px;
                height: auto;
                aspect-ratio: 390 / 844;
                transform: none;
                border-width: 2px;
            }
            
            .phone-container:hover {
                transform: none;
            }
        }
        
        @media (min-width: 401px) {
            .phone-container {
                transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            }
        }
        
    </style>
</head>
<body>
    <div class="phone-container">
        <!-- å±å¹•ä¿æŠ¤è£…é¥° -->
        <div class="screen-protector"></div>
        
        <!-- iPhone 13 åˆ˜æµ· -->
        <div class="notch"></div>
        
        <!-- çŠ¶æ€æ  -->
        <div class="status-bar">
            <div class="status-time">13:34</div>
            <div class="status-icons">
                <svg width="18" height="18" fill="#1f2937" viewBox="0 0 20 20">
                    <path d="M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z"></path>
                </svg>
                <svg width="18" height="18" fill="#1f2937" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M17.778 8.222c-4.296-4.296-11.26-4.296-15.556 0A1 1 0 01.808 6.808c5.076-5.077 13.308-5.077 18.384 0a1 1 0 01-1.414 1.414zM14.95 11.05a7 7 0 00-9.9 0 1 1 0 01-1.414-1.414 9 9 0 0112.728 0 1 1 0 01-1.414 1.414zM12.12 13.88a3 3 0 00-4.242 0 1 1 0 01-1.415-1.415 5 5 0 017.072 0 1 1 0 01-1.415 1.415zM9 16a1 1 0 011-1v0a1 1 0 110 2v0a1 1 0 01-1-1z"></path>
                </svg>
                <div class="battery">
                    <div class="battery-level"></div>
                </div>
            </div>
        </div>
        
        <!-- ä¸»å†…å®¹åŒº -->
        <div class="main-content">
            <!-- é¦–é¡µå†…å®¹ -->
            <div id="home" class="page-content active">
                <div class="page-header">
                    <h1 class="page-title">å…‰ä¼</h1>
                    <p class="page-subtitle">ä»Šå¤© 8æœˆ 20æ—¥</p>
                </div>
                
                <div class="status-card">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <div class="power-reading">7.2<span style="font-size:28px;color:#86868b;font-weight:500;margin-left:6px;">kW</span></div>
                        <div class="power-label">å½“å‰å‘ç”µåŠŸç‡</div>
                    </div>
                    <div style="display:flex;justify-content:center;align-items:center;">
                        <div style="width:8px;height:8px;background:#30d158;border-radius:50%;margin-right:8px;"></div>
                        <div style="font-size:17px;color:#1d1d1f;font-weight:500;">ç³»ç»Ÿæ­£å¸¸è¿è¡Œ</div>
                    </div>
                </div>
                
                <div class="energy-cards">
                    <div class="energy-card">
                        <div class="energy-value">2.4<span class="energy-unit">kW</span></div>
                        <div class="energy-label">å®¶åº­ç”¨ç”µ</div>
                    </div>
                    <div class="energy-card">
                        <div class="energy-value">85<span class="energy-unit">%</span></div>
                        <div class="energy-label">ç”µæ± ç”µé‡</div>
                    </div>
                </div>
                
                <div class="summary-grid">
                    <div class="summary-item">
                        <div class="summary-value">36.4 kWh</div>
                        <div class="summary-label">ä»Šæ—¥å‘ç”µ</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value">Â¥18.2</div>
                        <div class="summary-label">ä»Šæ—¥æ”¶ç›Š</div>
                    </div>
                </div>
            </div>
            
            <!-- å†å²é¡µé¢ -->
            <div id="history" class="page-content">
                <div class="page-header">
                    <h1 class="page-title">å†å²</h1>
                    <p class="page-subtitle">å‘ç”µè®°å½•</p>
                </div>
                
                <div class="summary-grid" style="margin-bottom: 16px;">
                    <div class="summary-item">
                        <div class="summary-value">203 kWh</div>
                        <div class="summary-label">æœ¬å‘¨å‘ç”µ</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value">Â¥101</div>
                        <div class="summary-label">æœ¬å‘¨æ”¶ç›Š</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value">1.2 MWh</div>
                        <div class="summary-label">æœ¬æœˆå‘ç”µ</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value">95%</div>
                        <div class="summary-label">è¾¾æˆç‡</div>
                    </div>
                </div>
                
                <div style="text-align: center; color: #8e8e93; font-size: 17px; margin-top: 60px;">
                    ğŸ“Š<br><br>è¯¦ç»†å›¾è¡¨åŠŸèƒ½<br>å³å°†ä¸Šçº¿
                </div>
            </div>
            
            <!-- è®¾å¤‡é¡µé¢ -->
            <div id="device" class="page-content">
                <div class="page-header">
                    <div style="display: flex; justify-content: space-between; align-items: flex-end;">
                        <div>
                            <h1 class="page-title">è®¾å¤‡</h1>
                        </div>
                        <div style="background: #007aff; border-radius: 50%; width: 36px; height: 36px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 12px rgba(0, 122, 255, 0.3);" onclick="openAddDevice()" onmousedown="this.style.transform='scale(0.9)'" onmouseup="this.style.transform='scale(1)'" onmouseleave="this.style.transform='scale(1)'">
                            <svg width="18" height="18" fill="white" viewBox="0 0 24 24">
                                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"/>
                            </svg>
                        </div>
                    </div>
                </div>
                
                <!-- æ— è®¾å¤‡æ—¶çš„ç¼ºçœé¡µé¢ -->
                <div id="emptyDeviceState" style="display: flex; flex-direction: column; align-items: center; justify-content: center; flex: 1; text-align: center; padding: 40px 20px;">
                    <!-- è®¾å¤‡å›¾æ ‡ -->
                    <div style="width: 120px; height: 120px; background: rgba(0, 122, 255, 0.08); border-radius: 60px; display: flex; align-items: center; justify-content: center; margin-bottom: 32px;">
                        <svg width="60" height="60" fill="none" viewBox="0 0 24 24">
                            <path stroke="#007aff" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M13 13v8h8v-8h-8zM3 21h8v-8H3v8zM3 3v8h8V3H3zm13.66-1.31L11 7.34 16.66 13l5.66-5.66-5.66-5.65z"/>
                        </svg>
                    </div>
                    
                    <!-- æ ‡é¢˜å’Œæè¿° -->
                    <h2 style="font-size: 22px; font-weight: 600; color: #1d1d1f; margin: 0 0 40px 0; letter-spacing: -0.2px;">è¿˜æ²¡æœ‰è®¾å¤‡</h2>
                    
                    <!-- æ·»åŠ è®¾å¤‡æŒ‰é’® -->
                    <div style="background: #007aff; border-radius: 14px; padding: 16px 32px; cursor: pointer; transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94); box-shadow: 0 4px 12px rgba(0, 122, 255, 0.3);" onclick="openAddDevice()" onmousedown="this.style.transform='scale(0.96)'" onmouseup="this.style.transform='scale(1)'" onmouseleave="this.style.transform='scale(1)'">
                        <div style="color: white; font-size: 17px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"/>
                            </svg>
                            æ·»åŠ è®¾å¤‡
                        </div>
                    </div>
                    
                </div>
                
                <!-- æœ‰è®¾å¤‡æ—¶çš„åˆ—è¡¨ï¼ˆéšè—ï¼‰ -->
                <div id="deviceListState" style="display: none;">
                    <div style="display: grid; gap: 12px;">
                        <!-- è®¾å¤‡å¡ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
                    </div>
                    
                    <!-- åº•éƒ¨æ·»åŠ æŒ‰é’® -->
                    <div style="margin-top: 24px; text-align: center;">
                        <div style="display: inline-block; background: rgba(0, 122, 255, 0.1); border: 1px solid #007aff; border-radius: 16px; padding: 12px 24px; cursor: pointer; transition: all 0.3s ease;" onclick="openAddDevice()">
                            <div style="color: #007aff; font-size: 15px; font-weight: 500;">+ æ·»åŠ æ›´å¤šè®¾å¤‡</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- è®¾ç½®é¡µé¢ -->
            <div id="settings" class="page-content">
                <div class="page-header">
                    <h1 class="page-title">ç³»ç»Ÿè®¾ç½®</h1>
                    <p class="page-subtitle">ç®¡ç†ç³»ç»Ÿé…ç½®å’Œåå¥½</p>
                </div>
                
                <div style="display: grid; gap: 12px;">
                    <div id="networkConfigItem" onclick="openNetworkSettingsPanel()" style="background: #ffffff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 16px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); cursor: pointer; transition: all 0.2s ease;" onmouseover="this.style.background='#f9fafb'" onmouseout="this.style.background='#ffffff'">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <div style="width: 32px; height: 32px; background: linear-gradient(135deg, #10B981, #059669); border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                                    <svg width="18" height="18" fill="white" viewBox="0 0 24 24">
                                        <path d="M1 9l2 2c4.97-4.97 13.03-4.97 18 0l2-2C16.93 2.93 7.08 2.93 1 9zm8 8l3 3 3-3c-1.65-1.66-4.34-1.66-6 0zm-4-4l2 2c2.76-2.76 7.24-2.76 10 0l2-2C15.14 9.14 8.87 9.14 5 13z"/>
                                    </svg>
                                </div>
                                <span style="font-size: 16px; font-weight: 500;">ç½‘ç»œé…ç½®</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <span style="color: #10B981; font-size: 14px;">å·²è¿æ¥</span>
                                <svg width="20" height="20" fill="#9ca3af" viewBox="0 0 24 24">
                                    <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/>
                                </svg>
                            </div>
                        </div>
                    </div>
                    
                    <div style="background: #ffffff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 16px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span>é€šçŸ¥è®¾ç½®</span>
                            <span style="color: #9333EA; font-size: 14px;">å¼€å¯</span>
                        </div>
                    </div>
                    
                    <div style="background: #ffffff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 16px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span>å¤œé—´æ¨¡å¼</span>
                            <span style="color: #6b7280; font-size: 14px;">å…³é—­</span>
                        </div>
                    </div>
                    
                    <div style="background: #ffffff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 16px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span>è¯­è¨€è®¾ç½®</span>
                            <span style="color: #6b7280; font-size: 14px;">ä¸­æ–‡</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- æˆ‘çš„é¡µé¢ -->
            <div id="mine" class="page-content">
                <div class="page-header">
                    <h1 class="page-title">æˆ‘çš„è´¦æˆ·</h1>
                    <p class="page-subtitle">ä¸ªäººä¿¡æ¯ä¸ç»Ÿè®¡</p>
                </div>
                
                <div style="text-align: center; margin-bottom: 30px;">
                    <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #9333EA, #06B6D4); border-radius: 50%; margin: 0 auto 16px; display: flex; align-items: center; justify-content: center; font-size: 32px;">ğŸ‘¤</div>
                    <div style="font-weight: 600; margin-bottom: 4px;">å…‰ä¼ç”¨æˆ·</div>
                    <div style="font-size: 14px; color: #71717A;">ID: 20240120001</div>
                    <div style="background: linear-gradient(135deg, #ffd700, #ffb300); color: white; padding: 4px 16px; border-radius: 12px; font-size: 12px; margin-top: 8px; display: inline-block;">VIPä¼šå‘˜</div>
                </div>
                
                <div class="energy-cards">
                    <div class="energy-card">
                        <div class="energy-value">12,458<span class="energy-unit">kWh</span></div>
                        <div class="energy-label">ç´¯è®¡å‘ç”µé‡</div>
                    </div>
                    <div class="energy-card">
                        <div class="energy-value">Â¥8,920</div>
                        <div class="energy-label">ç´¯è®¡èŠ‚çœ</div>
                    </div>
                    <div class="energy-card">
                        <div class="energy-value">6,229<span class="energy-unit">kg</span></div>
                        <div class="energy-label">å‡å°‘COâ‚‚</div>
                    </div>
                    <div class="energy-card">
                        <div class="energy-value">311</div>
                        <div class="energy-label">ç›¸å½“äºæ¤æ ‘</div>
                    </div>
                </div>
                
                <!-- è“ç‰™è¿æ¥æŒ‰é’® -->
                <div style="margin-top: 24px;">
                    <button onclick="openBluetoothModal()" style="
                        width: 100%; 
                        background: linear-gradient(135deg, #007AFF, #5856D6); 
                        border: none; 
                        color: white; 
                        font-size: 17px; 
                        font-weight: 600; 
                        padding: 16px 24px; 
                        border-radius: 16px; 
                        cursor: pointer; 
                        display: flex; 
                        align-items: center; 
                        justify-content: center; 
                        gap: 8px;
                        transition: all 0.2s ease;
                    " onmouseover="this.style.transform='scale(0.98)'" onmouseout="this.style.transform='scale(1)'">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="white">
                            <path d="M12 2L17 7L13 11L17 15L12 20V12L8 16L6 14L10 10L6 6L8 4L12 8V2Z"/>
                        </svg>
                        è“ç‰™è¿æ¥
                    </button>
                </div>
            </div>
        </div>
        
        
        <!-- æ·»åŠ è®¾å¤‡é¡µé¢ -->
        <div id="addDevicePage" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: #ffffff; z-index: 1500; display: none; transform: translateX(100%);">
            <!-- çŠ¶æ€æ  -->
            <div class="status-bar">
                <div class="status-time">13:34</div>
                <div class="status-icons">
                    <svg width="18" height="18" fill="#1d1d1f" viewBox="0 0 20 20">
                        <path d="M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z"></path>
                    </svg>
                    <svg width="18" height="18" fill="#1d1d1f" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M17.778 8.222c-4.296-4.296-11.26-4.296-15.556 0A1 1 0 01.808 6.808c5.076-5.077 13.308-5.077 18.384 0a1 1 0 01-1.414 1.414zM14.95 11.05a7 7 0 00-9.9 0 1 1 0 01-1.414-1.414 9 9 0 0112.728 0 1 1 0 01-1.414 1.414zM12.12 13.88a3 3 0 00-4.242 0 1 1 0 01-1.415-1.415 5 5 0 017.072 0 1 1 0 01-1.415 1.415zM9 16a1 1 0 011-1v0a1 1 0 110 2v0a1 1 0 01-1-1z"></path>
                    </svg>
                    <div class="battery">
                        <div class="battery-level"></div>
                    </div>
                </div>
            </div>
            
            <!-- å¯¼èˆªæ  -->
            <div style="height: 44px; display: flex; align-items: center; padding: 0 20px; border-bottom: 0.5px solid rgba(0, 0, 0, 0.1);">
                <button onclick="closeAddDevicePage()" style="background: none; border: none; padding: 8px; margin-left: -8px; cursor: pointer; display: flex; align-items: center; justify-content: center;">
                    <svg width="24" height="24" fill="#007aff" viewBox="0 0 24 24">
                        <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                    </svg>
                </button>
                <div style="flex: 1; text-align: center; font-size: 17px; font-weight: 600; color: #1d1d1f;">æ·»åŠ è®¾å¤‡</div>
                <button onclick="openQRScanner()" style="background: none; border: none; padding: 8px; margin-right: -8px; cursor: pointer; display: flex; align-items: center; justify-content: center;">
                    <svg width="24" height="24" fill="#007aff" viewBox="0 0 24 24">
                        <path d="M3 3h4v2H5v2H3V3zm14 0h4v4h-2V5h-2V3zM3 17v4h4v-2H5v-2H3zm16 0v2h-2v2h4v-4h-2z"/>
                        <path d="M9 9h2v2H9V9zm4 0h2v2h-2V9zm0 4h2v2h-2v-2zm-4 0h2v2H9v-2z"/>
                        <rect x="6" y="12" width="1" height="6"/>
                        <rect x="12" y="6" width="6" height="1"/>
                    </svg>
                </button>
            </div>
            
            <!-- æ‰«æåŒºåŸŸ -->
            <div style="padding: 24px; text-align: center;">
                <div style="color: #1d1d1f; font-size: 20px; font-weight: 600; margin-bottom: 4px;">æ‰«æé™„è¿‘è®¾å¤‡</div>
                <div style="color: #86868b; font-size: 14px; margin-bottom: 32px;">æŒç»­è‡ªåŠ¨æœç´¢ä¸­...</div>
                
                <!-- æ‰«æåŠ¨ç”» -->
                <div id="scanningAnimation" style="width: 200px; height: 200px; margin: 20px auto; border: 3px solid rgba(0, 0, 0, 0.1); border-radius: 20px; position: relative; overflow: hidden; background: rgba(0, 122, 255, 0.02);">
                    <!-- æ‰«æçº¿ -->
                    <div style="position: absolute; width: 100%; height: 3px; background: linear-gradient(90deg, transparent, #007aff, transparent); animation: scanLine 2s linear infinite;"></div>
                    
                    <!-- æ‰‹æœºå›¾æ ‡ -->
                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 60px; height: 90px; border: 2px solid #86868b; border-radius: 12px; background: #f8f8f8;">
                        <!-- åˆ˜æµ· -->
                        <div style="position: absolute; top: 8px; left: 50%; transform: translateX(-50%); width: 20px; height: 3px; background: #86868b; border-radius: 2px;"></div>
                        <!-- HomeæŒ‡ç¤ºå™¨ -->
                        <div style="position: absolute; bottom: 6px; left: 50%; transform: translateX(-50%); width: 20px; height: 2px; background: #86868b; border-radius: 1px;"></div>
                    </div>
                </div>
                
                <!-- å‘ç°çš„è®¾å¤‡åˆ—è¡¨ -->
                <div id="foundDevicesSection" style="display: none;">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px;">
                        <div style="color: #1d1d1f; font-size: 18px; font-weight: 600;">å‘ç° <span id="deviceCount">0</span> ä¸ªè®¾å¤‡</div>
                        <button onclick="refreshDeviceScan()" style="background: none; border: none; padding: 4px; cursor: pointer; display: flex; align-items: center; justify-content: center;">
                            <svg width="20" height="20" fill="#007aff" viewBox="0 0 24 24">
                                <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
                            </svg>
                        </button>
                    </div>
                    <div id="foundDevicesList" style="display: grid; gap: 12px;"></div>
                </div>
            </div>
        </div>
        
        <!-- äºŒç»´ç æ‰«æé¡µé¢ -->
        <div id="qrScanPage" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: #000000; z-index: 1600; display: none; transform: translateX(100%);">
            <!-- çŠ¶æ€æ  -->
            <div class="status-bar" style="background: transparent;">
                <div class="status-time" style="color: white;">13:34</div>
                <div class="status-icons">
                    <svg width="18" height="18" fill="white" viewBox="0 0 20 20">
                        <path d="M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z"></path>
                    </svg>
                    <div class="battery" style="border-color: white;">
                        <div class="battery-level" style="background: white;"></div>
                    </div>
                </div>
            </div>
            
            <!-- å¯¼èˆªæ  -->
            <div style="height: 44px; display: flex; align-items: center; padding: 0 20px; background: transparent;">
                <button onclick="closeQRScanner()" style="background: none; border: none; padding: 8px; margin-left: -8px; cursor: pointer; display: flex; align-items: center; justify-content: center;">
                    <svg width="24" height="24" fill="white" viewBox="0 0 24 24">
                        <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                    </svg>
                </button>
                <div style="flex: 1; text-align: center; font-size: 17px; font-weight: 600; color: white;">æ‰«ç æ·»åŠ è®¾å¤‡</div>
                <div style="width: 40px;"></div>
            </div>
            
            <!-- æ‰«æåŒºåŸŸ -->
            <div style="flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 40px 20px;">
                <!-- æ‰‹æœºå›¾æ ‡ -->
                <div style="font-size: 80px; margin-bottom: 32px;">ğŸ“±</div>
                
                <!-- æ‰«ææ¡† -->
                <div class="qr-scan-frame" style="position: relative; width: 280px; height: 280px; margin-bottom: 40px;">
                    <!-- æ‰«ææ¡†è¾¹è§’ -->
                    <div style="position: absolute; top: 0; left: 0; width: 40px; height: 40px; border-top: 4px solid #007aff; border-left: 4px solid #007aff; border-radius: 8px 0 0 0;"></div>
                    <div style="position: absolute; top: 0; right: 0; width: 40px; height: 40px; border-top: 4px solid #007aff; border-right: 4px solid #007aff; border-radius: 0 8px 0 0;"></div>
                    <div style="position: absolute; bottom: 0; left: 0; width: 40px; height: 40px; border-bottom: 4px solid #007aff; border-left: 4px solid #007aff; border-radius: 0 0 0 8px;"></div>
                    <div style="position: absolute; bottom: 0; right: 0; width: 40px; height: 40px; border-bottom: 4px solid #007aff; border-right: 4px solid #007aff; border-radius: 0 0 8px 0;"></div>
                    
                    <!-- æ‰«æçº¿åŠ¨ç”» -->
                    <div class="qr-scan-line" style="position: absolute; top: 50px; left: 20px; right: 20px; height: 2px; background: #007aff; box-shadow: 0 0 10px #007aff; animation: qrScan 2s ease-in-out infinite;"></div>
                    
                    <!-- æ¨¡æ‹Ÿæ‘„åƒå¤´é¢„è§ˆ -->
                    <div style="position: absolute; top: 20px; left: 20px; right: 20px; bottom: 20px; background: rgba(255, 255, 255, 0.05); border-radius: 8px;"></div>
                </div>
                
                <div style="color: white; font-size: 18px; font-weight: 600; margin-bottom: 8px; text-align: center;">å¯¹å‡†è®¾å¤‡ä¸Šçš„äºŒç»´ç </div>
                <div style="color: rgba(255, 255, 255, 0.7); font-size: 14px; text-align: center; line-height: 1.5; max-width: 280px;">è¯·å°†æ‘„åƒå¤´å¯¹å‡†è®¾å¤‡æ ‡ç­¾ä¸Šçš„äºŒç»´ç <br>ä¿æŒé€‚å½“è·ç¦»ä»¥è·å¾—æœ€ä½³è¯†åˆ«æ•ˆæœ</div>
                
                <!-- æ‰«ææˆåŠŸåŒºåŸŸ -->
                <div id="qrSuccessArea"></div>
            </div>
        </div>
        
        <style>
        @keyframes scanLine {
            0% { top: 0; }
            100% { top: 100%; }
        }
        
        @keyframes qrScan {
            0%, 50% { top: 50px; opacity: 1; }
            100% { top: 200px; opacity: 0.3; }
        }
        </style>
        
        <!-- åº•éƒ¨å¯¼èˆªæ  -->
        <div class="bottom-navigation">
            <div class="nav-item active" onclick="switchPage('home', this)">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                </svg>
                <span class="nav-label">é¦–é¡µ</span>
            </div>
            
            <div class="nav-item" onclick="switchPage('history', this)">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"/>
                </svg>
                <span class="nav-label">å†å²</span>
            </div>
            
            <div class="nav-item" onclick="switchPage('device', this)">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M13 13v8h8v-8h-8zM3 21h8v-8H3v8zM3 3v8h8V3H3zm13.66-1.31L11 7.34 16.66 13l5.66-5.66-5.66-5.65z"/>
                </svg>
                <span class="nav-label">è®¾å¤‡</span>
            </div>
            
            <div class="nav-item" onclick="switchPage('settings', this)">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/>
                </svg>
                <span class="nav-label">è®¾ç½®</span>
            </div>
            
            <div class="nav-item" onclick="switchPage('mine', this)">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                </svg>
                <span class="nav-label">æˆ‘çš„</span>
            </div>
            
            <!-- Home Indicator -->
            <div class="home-indicator"></div>
        </div>
    </div>

    <script>
        // æ£€æŸ¥ç™»å½•çŠ¶æ€
        function checkLoginStatus() {
            const isLoggedIn = localStorage.getItem('isLoggedIn');
            if (!isLoggedIn || isLoggedIn !== 'true') {
                // æœªç™»å½•ï¼Œè·³è½¬åˆ°ç™»å½•é¡µé¢
                window.location.href = 'login.html';
                return false;
            }
            return true;
        }
        
        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥ç™»å½•çŠ¶æ€
        window.addEventListener('load', function() {
            checkLoginStatus();
        });
        
        // é¡µé¢åˆ‡æ¢åŠŸèƒ½
        function switchPage(pageId, navElement) {
            // éšè—æ‰€æœ‰é¡µé¢
            const pages = document.querySelectorAll('.page-content');
            pages.forEach(page => page.classList.remove('active'));
            
            // æ˜¾ç¤ºé€‰ä¸­é¡µé¢
            document.getElementById(pageId).classList.add('active');
            
            // æ›´æ–°å¯¼èˆªçŠ¶æ€
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => item.classList.remove('active'));
            navElement.classList.add('active');
        }
        
        
        // è®¾å¤‡è¯¦æƒ…ç›¸å…³å‡½æ•°
        function openDeviceDetail(deviceName, deviceSN, isOnline) {
            // è·³è½¬åˆ°è®¾å¤‡è¯¦æƒ…é¡µé¢
            window.location.href = 'home.html';
        }
        
        
        
        // è®¾å¤‡æ•°æ®å­˜å‚¨
        let devices = [];
        let lastAddedDevice = null; // è®°å½•æœ€åæ·»åŠ çš„è®¾å¤‡
        
        function openAddDevice() {
            // ä¸´æ—¶æ¸…ç†æƒé™ç”¨äºæµ‹è¯• - å¯ä»¥åˆ é™¤è¿™ä¸¤è¡Œ
            localStorage.removeItem('locationPermission');
            localStorage.removeItem('bluetoothPermission');
            
            // ç›´æ¥è¿›å…¥æ·»åŠ è®¾å¤‡é¡µé¢
            showAddDevicePage();
        }
        
        function showAddDevicePage() {
            // æ£€æŸ¥æƒé™çŠ¶æ€
            const locationPermission = localStorage.getItem('locationPermission');
            const bluetoothPermission = localStorage.getItem('bluetoothPermission');
            
            console.log('Checking permissions:', { locationPermission, bluetoothPermission });
            
            // å¦‚æœå·²æœ‰æƒé™ï¼Œç›´æ¥æ˜¾ç¤ºæ·»åŠ è®¾å¤‡é¡µé¢
            if (locationPermission && bluetoothPermission === 'allowed') {
                console.log('Permissions already granted, showing device page directly');
                showAddDevicePageDirectly();
                return;
            }
            
            // å¦åˆ™å…ˆæ˜¾ç¤ºæƒé™è¯·æ±‚å¼¹çª—
            console.log('Showing location permission dialog');
            showLocationPermissionDialog();
        }
        
        function showAddDevicePageDirectly() {
            const addPage = document.getElementById('addDevicePage');
            const phoneContainer = document.querySelector('.phone-container');
            
            // éšè—æ‰‹æœºå¤–å£³çš„3Dæ•ˆæœ
            phoneContainer.style.transform = 'perspective(1000px) rotateX(0deg) rotateY(0deg)';
            
            // æ˜¾ç¤ºæ·»åŠ è®¾å¤‡é¡µé¢
            addPage.style.display = 'block';
            
            // æ·»åŠ é¡µé¢åˆ‡æ¢åŠ¨ç”»
            setTimeout(() => {
                addPage.style.transform = 'translateX(0)';
                addPage.style.transition = 'transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94)';
            }, 10);
            
            // å¼€å§‹æ‰«æè®¾å¤‡
            setTimeout(() => {
                showFoundDevices();
            }, 3000);
        }
        
        function closeAddDevicePage() {
            const addPage = document.getElementById('addDevicePage');
            const phoneContainer = document.querySelector('.phone-container');
            
            // æ¢å¤æ‰‹æœºå¤–å£³çš„3Dæ•ˆæœ
            phoneContainer.style.transform = 'perspective(1000px) rotateX(-5deg) rotateY(2deg)';
            
            // éšè—æ·»åŠ è®¾å¤‡é¡µé¢
            addPage.style.transform = 'translateX(100%)';
            setTimeout(() => {
                addPage.style.display = 'none';
            }, 300);
        }
        
        function refreshDeviceScan() {
            // éšè—å‘ç°è®¾å¤‡åˆ—è¡¨
            const foundDevicesSection = document.getElementById('foundDevicesSection');
            if (foundDevicesSection) {
                foundDevicesSection.style.display = 'none';
            }
            
            // æ˜¾ç¤ºæ‰«æåŠ¨ç”»
            const scanningAnimation = document.getElementById('scanningAnimation');
            if (scanningAnimation) {
                scanningAnimation.style.display = 'block';
            }
            
            // é‡æ–°å¼€å§‹æ‰«æ
            setTimeout(() => {
                showFoundDevices();
            }, 3000);
            
            // æ˜¾ç¤ºåˆ·æ–°æˆåŠŸæç¤º
            showSuccessMessage('æ­£åœ¨åˆ·æ–°æ‰«æ...');
        }
        
        function startBluetoothScanPage() {
            closeAddDevicePage();
            setTimeout(() => {
                showBluetoothScanModal();
            }, 300);
        }
        
        function showManualAddPage() {
            closeAddDevicePage();
            setTimeout(() => {
                showManualAddOptions();
            }, 300);
        }
        
        function showFoundDevices() {
            const foundDevicesSection = document.getElementById('foundDevicesSection');
            const foundDevicesList = document.getElementById('foundDevicesList');
            const deviceCount = document.getElementById('deviceCount');
            
            // æ¨¡æ‹Ÿå‘ç°çš„è®¾å¤‡
            const discoveredDevices = [
                { name: 'BEI-001', id: 'SN2024012345', type: 'å‚¨èƒ½ç³»ç»Ÿ', icon: 'ğŸ”‹' },
                { name: 'PV-102', id: 'SN2024012346', type: 'å…‰ä¼é€†å˜å™¨', icon: 'â˜€ï¸' },
                { name: 'EV-203', id: 'SN2024012347', type: 'å……ç”µæ¡©', icon: 'âš¡' }
            ];
            
            deviceCount.textContent = discoveredDevices.length;
            foundDevicesList.innerHTML = '';
            
            discoveredDevices.forEach((device, index) => {
                const deviceItem = document.createElement('div');
                deviceItem.style.cssText = `
                    background: rgba(255, 255, 255, 0.9);
                    backdrop-filter: blur(20px);
                    -webkit-backdrop-filter: blur(20px);
                    border-radius: 16px;
                    border: 0.5px solid rgba(0, 0, 0, 0.04);
                    padding: 16px;
                    cursor: pointer;
                    transition: all 0.3s ease;
                `;
                
                deviceItem.innerHTML = `
                    <div style="display: flex; align-items: center; justify-content: space-between;">
                        <div>
                            <div style="color: #1d1d1f; font-size: 16px; font-weight: 600;">${device.name}</div>
                        </div>
                        <div id="add-status-${index}">
                            <button onclick="confirmAddDevice('${device.name}', '${device.type}', '${device.id}', ${index})" style="background: #007aff; color: white; border: none; border-radius: 8px; padding: 8px 16px; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.3s ease;">æ·»åŠ </button>
                        </div>
                    </div>
                `;
                
                foundDevicesList.appendChild(deviceItem);
            });
            
            foundDevicesSection.style.display = 'block';
        }
        
        function confirmAddDevice(deviceName, deviceType, deviceId, index) {
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            const statusDiv = document.getElementById(`add-status-${index}`);
            statusDiv.innerHTML = '<div style="color: #30d158; font-size: 14px; font-weight: 600;">âœ“ å·²æ·»åŠ </div>';
            
            // æ·»åŠ åˆ°è®¾å¤‡åˆ—è¡¨
            const deviceIcons = {
                'å‚¨èƒ½ç³»ç»Ÿ': 'ğŸ”‹',
                'å…‰ä¼é€†å˜å™¨': 'â˜€ï¸',
                'å……ç”µæ¡©': 'âš¡'
            };
            
            const newDevice = {
                id: `device_${Date.now()}`,
                name: deviceName,
                type: deviceType,
                sn: deviceId,
                online: true,
                icon: deviceIcons[deviceType] || 'ğŸ”§',
                soc: Math.floor(Math.random() * 40) + 60,
                soh: Math.floor(Math.random() * 10) + 90,
                status: Math.random() > 0.5 ? 'å……ç”µ' : 'æ”¾ç”µ'
            };
            
            devices.push(newDevice);
            lastAddedDevice = newDevice; // è®°å½•æœ€åæ·»åŠ çš„è®¾å¤‡
            
            // æ˜¾ç¤ºæˆåŠŸæç¤º
            showSuccessMessage('æ·»åŠ æˆåŠŸ');
            
            // 2ç§’åå…³é—­é¡µé¢å¹¶æ›´æ–°è®¾å¤‡åˆ—è¡¨
            setTimeout(() => {
                closeAddDevicePage();
                updateDeviceDisplay();
                // æ˜¾ç¤ºç½‘ç»œé…ç½®å¼¹çª—
                setTimeout(() => {
                    showNetworkConfigModal();
                }, 500);
            }, 2000);
        }
        
        function startBluetoothScan() {
            closeAddDevice();
            showBluetoothScanModal();
        }
        
        function showBluetoothScanModal() {
            const scanHTML = `
                <div id="bluetoothScanModal" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.8); z-index: 1000; display: flex; align-items: center; justify-content: center;">
                    <div style="background: #1a1a1a; border-radius: 24px; width: 90%; max-width: 350px; padding: 0; overflow: hidden; position: relative;">
                        <!-- å¤´éƒ¨ -->
                        <div style="background: linear-gradient(135deg, #007aff, #0056b3); padding: 20px; text-align: center; position: relative;">
                            <button onclick="closeBluetooth()" style="position: absolute; top: 16px; right: 16px; background: rgba(255, 255, 255, 0.1); border: none; border-radius: 50%; width: 32px; height: 32px; color: white; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 18px;">Ã—</button>
                            <h2 style="color: white; margin: 0 0 8px 0; font-size: 20px; font-weight: 600;">è“ç‰™æ‰«æ</h2>
                            <div style="color: rgba(255, 255, 255, 0.8); font-size: 14px;">æœç´¢é™„è¿‘çš„è®¾å¤‡</div>
                        </div>
                        
                        <!-- æ‰«æå†…å®¹ -->
                        <div style="padding: 24px;">
                            <!-- æ‰«æåŠ¨ç”» -->
                            <div id="scanningAnimation" style="text-align: center; margin-bottom: 24px;">
                                <div style="width: 80px; height: 80px; margin: 0 auto 16px; border: 3px solid #007aff; border-radius: 50%; border-top: 3px solid transparent; animation: spin 1s linear infinite;"></div>
                                <div style="color: white; font-size: 16px; font-weight: 600; margin-bottom: 4px;">æ­£åœ¨æ‰«æ...</div>
                                <div style="color: #86868b; font-size: 14px;">è¯·å°†æ‰‹æœºé è¿‘è¦æ·»åŠ çš„è®¾å¤‡</div>
                            </div>
                            
                            <!-- å‘ç°çš„è®¾å¤‡åˆ—è¡¨ -->
                            <div id="discoveredDevices" style="display: none;">
                                <div style="color: white; font-size: 16px; font-weight: 600; margin-bottom: 16px;">å‘ç° <span id="deviceCount">0</span> å°è®¾å¤‡</div>
                                <div id="deviceList" style="display: grid; gap: 12px;">
                                    <!-- è®¾å¤‡å°†é€šè¿‡JSåŠ¨æ€æ·»åŠ  -->
                                </div>
                            </div>
                            
                            <!-- åº•éƒ¨æŒ‰é’® -->
                            <div style="margin-top: 24px; text-align: center;">
                                <div onclick="showManualAddOptions()" style="background: transparent; border: 1px solid #3a3a3a; border-radius: 12px; padding: 12px 20px; cursor: pointer; transition: all 0.3s ease; display: inline-block;" onmouseover="this.style.borderColor='#007aff'" onmouseout="this.style.borderColor='#3a3a3a'">
                                    <div style="color: #86868b; font-size: 14px;">æ‰«æä¸åˆ°ï¼Ÿæ‰‹åŠ¨æ·»åŠ </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <style>
                @keyframes spin {
                    0% { transform: rotate(0deg); }
                    100% { transform: rotate(360deg); }
                }
                </style>
            `;
            
            document.querySelector('.phone-container').insertAdjacentHTML('beforeend', scanHTML);
            
            // æ¨¡æ‹Ÿè“ç‰™æ‰«æè¿‡ç¨‹
            setTimeout(() => {
                simulateDeviceDiscovery();
            }, 3000);
        }
        
        function simulateDeviceDiscovery() {
            // æ¨¡æ‹Ÿå‘ç°çš„è®¾å¤‡
            const discoveredDevicesList = [
                { name: 'å‚¨èƒ½ç³»ç»Ÿ BEI-001', type: 'å‚¨èƒ½ç³»ç»Ÿ', signal: 85, mac: 'AA:BB:CC:DD:EE:01' },
                { name: 'å…‰ä¼é€†å˜å™¨ PV-102', type: 'å…‰ä¼é€†å˜å™¨', signal: 72, mac: 'AA:BB:CC:DD:EE:02' },
                { name: 'å……ç”µæ¡© EV-203', type: 'å……ç”µæ¡©', signal: 68, mac: 'AA:BB:CC:DD:EE:03' }
            ];
            
            const scanAnimation = document.getElementById('scanningAnimation');
            const discoveredDevices = document.getElementById('discoveredDevices');
            const deviceList = document.getElementById('deviceList');
            const deviceCount = document.getElementById('deviceCount');
            
            if (scanAnimation) scanAnimation.style.display = 'none';
            if (discoveredDevices) discoveredDevices.style.display = 'block';
            if (deviceCount) deviceCount.textContent = discoveredDevicesList.length;
            
            const deviceIcons = {
                'å‚¨èƒ½ç³»ç»Ÿ': 'ğŸ”‹',
                'å…‰ä¼é€†å˜å™¨': 'â˜€ï¸',
                'å……ç”µæ¡©': 'âš¡'
            };
            
            if (deviceList) {
                deviceList.innerHTML = discoveredDevicesList.map(device => `
                    <div onclick="addDiscoveredDevice('${device.name}', '${device.type}', '${device.mac}')" style="background: #2a2a2a; border-radius: 12px; padding: 16px; cursor: pointer; transition: all 0.3s ease; border: 1px solid transparent;" onmouseover="this.style.borderColor='#007aff'" onmouseout="this.style.borderColor='transparent'">
                        <div style="display: flex; align-items: center; justify-content: space-between;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <div style="font-size: 24px;">${deviceIcons[device.type]}</div>
                                <div>
                                    <div style="color: white; font-size: 15px; font-weight: 600; margin-bottom: 2px;">${device.name}</div>
                                    <div style="color: #86868b; font-size: 12px;">${device.type} â€¢ ${device.mac}</div>
                                </div>
                            </div>
                            <div style="display: flex; align-items: center; gap: 6px;">
                                <div style="width: 12px; height: 8px; background: #30d158; border-radius: 1px;"></div>
                                <div style="width: 12px; height: 8px; background: ${device.signal > 70 ? '#30d158' : '#86868b'}; border-radius: 1px;"></div>
                                <div style="width: 12px; height: 8px; background: ${device.signal > 80 ? '#30d158' : '#86868b'}; border-radius: 1px;"></div>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
        }
        
        function addDiscoveredDevice(deviceName, deviceType, deviceMac) {
            const newDevice = {
                id: `device_${Date.now()}`,
                name: deviceName,
                type: deviceType,
                sn: deviceMac.replace(/:/g, ''),
                online: true,
                icon: deviceType === 'å‚¨èƒ½ç³»ç»Ÿ' ? 'ğŸ”‹' : deviceType === 'å…‰ä¼é€†å˜å™¨' ? 'â˜€ï¸' : 'âš¡',
                soc: Math.floor(Math.random() * 40) + 60,
                soh: Math.floor(Math.random() * 10) + 90,
                status: Math.random() > 0.5 ? 'å……ç”µ' : 'æ”¾ç”µ',
                networkConfigured: false // æ–°æ·»åŠ çš„è®¾å¤‡é»˜è®¤æœªé…ç½‘
            };
            
            devices.push(newDevice);
            lastAddedDevice = newDevice; // è®°å½•æœ€åæ·»åŠ çš„è®¾å¤‡
            closeBluetooth();
            updateDeviceDisplay();
            showSuccessMessage('æ·»åŠ æˆåŠŸ');
            
            // æ˜¾ç¤ºç½‘ç»œé…ç½®å¼¹çª—
            setTimeout(() => {
                showNetworkConfigModal();
            }, 500);
        }
        
        function closeBluetooth() {
            const modal = document.getElementById('bluetoothScanModal');
            if (modal) modal.remove();
        }
        
        function showManualAddOptions() {
            closeBluetooth();
            closeAddDevice();
            
            // æ˜¾ç¤ºæ‰‹åŠ¨æ·»åŠ è®¾å¤‡ç±»å‹é€‰æ‹©
            const manualAddHTML = `
                <div id="manualAddModal" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.8); z-index: 1000; display: flex; align-items: center; justify-content: center;">
                    <div style="background: #1a1a1a; border-radius: 24px; width: 90%; max-width: 350px; padding: 0; overflow: hidden; position: relative;">
                        <!-- å¤´éƒ¨ -->
                        <div style="background: linear-gradient(135deg, #34c759, #28a745); padding: 20px; text-align: center; position: relative;">
                            <button onclick="closeManualAdd()" style="position: absolute; top: 16px; right: 16px; background: rgba(255, 255, 255, 0.1); border: none; border-radius: 50%; width: 32px; height: 32px; color: white; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 18px;">Ã—</button>
                            <h2 style="color: white; margin: 0 0 8px 0; font-size: 20px; font-weight: 600;">æ‰‹åŠ¨æ·»åŠ </h2>
                            <div style="color: rgba(255, 255, 255, 0.8); font-size: 14px;">é€‰æ‹©è¦æ·»åŠ çš„è®¾å¤‡ç±»å‹</div>
                        </div>
                        
                        <!-- è®¾å¤‡ç±»å‹é€‰æ‹© -->
                        <div style="padding: 24px;">
                            <div style="display: grid; gap: 16px;">
                                <div onclick="addNewDevice('å‚¨èƒ½ç³»ç»Ÿ')" style="background: #2a2a2a; border-radius: 16px; padding: 20px; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent;" onmouseover="this.style.borderColor='#34c759'" onmouseout="this.style.borderColor='transparent'">
                                    <div style="display: flex; align-items: center; gap: 16px;">
                                        <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #9333EA, #6B46C1); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px;">ğŸ”‹</div>
                                        <div>
                                            <div style="color: white; font-size: 16px; font-weight: 600; margin-bottom: 4px;">å‚¨èƒ½ç³»ç»Ÿ</div>
                                            <div style="color: #86868b; font-size: 13px;">ç”µæ± å‚¨èƒ½ç®¡ç†ç³»ç»Ÿ</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div onclick="addNewDevice('å…‰ä¼é€†å˜å™¨')" style="background: #2a2a2a; border-radius: 16px; padding: 20px; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent;" onmouseover="this.style.borderColor='#34c759'" onmouseout="this.style.borderColor='transparent'">
                                    <div style="display: flex; align-items: center; gap: 16px;">
                                        <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #45B7D1, #96CEB4); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px;">â˜€ï¸</div>
                                        <div>
                                            <div style="color: white; font-size: 16px; font-weight: 600; margin-bottom: 4px;">å…‰ä¼é€†å˜å™¨</div>
                                            <div style="color: #86868b; font-size: 13px;">å¤ªé˜³èƒ½å‘ç”µè®¾å¤‡</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div onclick="addNewDevice('å……ç”µæ¡©')" style="background: #2a2a2a; border-radius: 16px; padding: 20px; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent;" onmouseover="this.style.borderColor='#34c759'" onmouseout="this.style.borderColor='transparent'">
                                    <div style="display: flex; align-items: center; gap: 16px;">
                                        <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #F59E0B, #D97706); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px;">âš¡</div>
                                        <div>
                                            <div style="color: white; font-size: 16px; font-weight: 600; margin-bottom: 4px;">å……ç”µæ¡©</div>
                                            <div style="color: #86868b; font-size: 13px;">ç”µåŠ¨æ±½è½¦å……ç”µè®¾å¤‡</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.querySelector('.phone-container').insertAdjacentHTML('beforeend', manualAddHTML);
        }
        
        function closeManualAdd() {
            const modal = document.getElementById('manualAddModal');
            if (modal) modal.remove();
        }
        
        function closeAddDevice() {
            const modal = document.getElementById('addDeviceModal');
            if (modal) {
                modal.remove();
            }
        }
        
        function addNewDevice(deviceType) {
            // ç”Ÿæˆè®¾å¤‡æ•°æ®
            const deviceNumber = devices.length + 1;
            const deviceIcons = {
                'å‚¨èƒ½ç³»ç»Ÿ': 'ğŸ”‹',
                'å…‰ä¼é€†å˜å™¨': 'â˜€ï¸',
                'å……ç”µæ¡©': 'âš¡'
            };
            
            const newDevice = {
                id: `device_${Date.now()}`,
                name: `${deviceType} ${deviceNumber.toString().padStart(2, '0')}`,
                type: deviceType,
                sn: `SN${new Date().getFullYear()}${Math.random().toString().substr(2, 6)}`,
                online: Math.random() > 0.3, // 70%æ¦‚ç‡åœ¨çº¿
                icon: deviceIcons[deviceType],
                soc: Math.floor(Math.random() * 40) + 60, // 60-100%
                soh: Math.floor(Math.random() * 10) + 90,  // 90-100%
                status: Math.random() > 0.5 ? 'å……ç”µ' : 'å¾…æœº',
                networkConfigured: false // æ–°æ·»åŠ çš„è®¾å¤‡é»˜è®¤æœªé…ç½‘
            };
            
            devices.push(newDevice);
            lastAddedDevice = newDevice; // è®°å½•æœ€åæ·»åŠ çš„è®¾å¤‡
            closeAddDevice();
            closeManualAdd();
            updateDeviceDisplay();
            
            // æ˜¾ç¤ºæ·»åŠ æˆåŠŸæç¤º
            showSuccessMessage(`${deviceType} æ·»åŠ æˆåŠŸï¼`);
            
            // æ˜¾ç¤ºç½‘ç»œé…ç½®å¼¹çª—
            setTimeout(() => {
                showNetworkConfigModal();
            }, 500);
        }
        
        function updateDeviceDisplay() {
            const emptyState = document.getElementById('emptyDeviceState');
            const listState = document.getElementById('deviceListState');
            const deviceContainer = listState.querySelector('div[style*="display: grid"]');
            const pageTitle = document.querySelector('#device .page-title');
            
            if (devices.length === 0) {
                emptyState.style.display = 'flex';
                listState.style.display = 'none';
                pageTitle.textContent = 'è®¾å¤‡';
            } else {
                emptyState.style.display = 'none';
                listState.style.display = 'block';
                
                // æ›´æ–°é¡µé¢æ ‡é¢˜
                pageTitle.textContent = 'è®¾å¤‡';
                
                // ç”Ÿæˆè®¾å¤‡å¡ç‰‡
                deviceContainer.innerHTML = devices.map((device, index) => `
                    <div onclick="openDeviceDetail('${device.name}', '${device.sn}', ${device.online})" style="background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border-radius: 18px; border: 0.5px solid rgba(0, 0, 0, 0.04); padding: 20px; transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94); position: relative; cursor: pointer;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 25px rgba(0, 0, 0, 0.15)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <div style="display: flex; align-items: center; flex: 1; gap: 8px;">
                                <div style="font-weight: 600; font-size: 17px; color: #1d1d1f;">${device.name}</div>
                                <div onclick="event.stopPropagation(); goToNetworkConfig()" style="color: ${device.networkConfigured ? '#2e7d0d' : '#fff'}; background-color: ${device.networkConfigured ? 'rgba(46, 125, 13, 0.1)' : '#d97706'}; font-size: 13px; font-weight: 500; cursor: pointer; transition: all 0.2s ease; padding: 4px 8px; border-radius: 6px;" onmouseover="this.style.opacity='0.7'" onmouseout="this.style.opacity='1'">
                                    ${device.networkConfigured ? 'å·²é…ç½‘' : 'æœªé…ç½‘'}>
                                </div>
                            </div>
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <div style="color: ${device.online ? '#30d158' : '#86868b'}; font-size: 13px; font-weight: 600;">â— ${device.online ? 'åœ¨çº¿' : 'ç¦»çº¿'}</div>
                                <button onclick="event.stopPropagation(); openDeviceDetail('${device.name}', '${device.sn}', ${device.online})" style="background: none; border: none; padding: 4px; cursor: pointer; display: flex; align-items: center; justify-content: center; border-radius: 4px; transition: all 0.2s ease; font-size: 16px;" onmouseover="this.style.background='rgba(0, 122, 255, 0.1)'" onmouseout="this.style.background='none'" title="æŸ¥çœ‹è¯¦æƒ…">
                                    â¡ï¸
                                </button>
                                <button onclick="event.stopPropagation(); showDeleteConfirmation('${device.id}', '${device.name}', ${index})" style="background: none; border: none; padding: 4px; cursor: pointer; display: flex; align-items: center; justify-content: center; border-radius: 4px; transition: all 0.2s ease;" onmouseover="this.style.background='rgba(255, 59, 48, 0.1)'" onmouseout="this.style.background='none'">
                                    <svg width="16" height="16" fill="#ff3b30" viewBox="0 0 24 24">
                                        <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div style="background: rgba(0, 0, 0, 0.02); border-radius: 12px; padding: 16px;">
                            <div style="display: flex; justify-content: space-around; margin-bottom: 16px;">
                                <div style="text-align: center;">
                                    <div style="color: #86868b; font-size: 11px; margin-bottom: 6px; letter-spacing: 0.2px;">çŠ¶æ€</div>
                                    <div style="color: #1d1d1f; font-size: 16px; font-weight: 600;">${device.status}</div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="color: #86868b; font-size: 11px; margin-bottom: 6px; letter-spacing: 0.2px;">SOC</div>
                                    <div style="color: #1d1d1f; font-size: 16px; font-weight: 600;">${device.soc}%</div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="color: #86868b; font-size: 11px; margin-bottom: 6px; letter-spacing: 0.2px;">SOH</div>
                                    <div style="color: #1d1d1f; font-size: 16px; font-weight: 600;">${device.soh}%</div>
                                </div>
                            </div>
                            <div style="border-top: 1px solid rgba(0, 0, 0, 0.08); padding-top: 12px; display: flex; justify-content: flex-end;">
                                <button onclick="event.stopPropagation(); openDeviceDetail('${device.name}', '${device.sn}', ${device.online})" style="background: none; border: none; padding: 8px 12px; cursor: pointer; display: flex; align-items: center; gap: 6px; border-radius: 8px; transition: all 0.2s ease; color: #007AFF; font-size: 14px; font-weight: 500;" onmouseover="this.style.background='rgba(0, 122, 255, 0.08)'" onmouseout="this.style.background='none'">
                                    <span>è¯¦æƒ…</span>
                                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M5 12h14"/>
                                        <path d="M12 5l7 7-7 7"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
        }
        
        // åˆ é™¤è®¾å¤‡åŠŸèƒ½
        function showDeleteConfirmation(deviceId, deviceName, deviceIndex) {
            const deleteModalHTML = `
                <div id="deleteConfirmModal" onclick="closeDeleteConfirmation()" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.4); z-index: 2000; display: flex; align-items: center; justify-content: center;">
                    <div onclick="event.stopPropagation()" style="background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(30px); -webkit-backdrop-filter: blur(30px); border-radius: 20px; width: 85%; max-width: 300px; overflow: hidden; box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15); border: 0.5px solid rgba(0, 0, 0, 0.1);">
                        <!-- å†…å®¹ -->
                        <div style="padding: 24px 20px 20px; text-align: center;">
                            <div style="color: #1d1d1f; font-size: 18px; font-weight: 600; margin-bottom: 8px; line-height: 1.3;">åˆ é™¤è®¾å¤‡"${deviceName}"ï¼Ÿ</div>
                            <div style="color: #86868b; font-size: 14px; line-height: 1.4;">è®¾å¤‡å°†ä»åˆ—è¡¨ä¸­æ°¸ä¹…ç§»é™¤ã€‚</div>
                        </div>
                        
                        <!-- æ“ä½œæŒ‰é’® -->
                        <div style="border-top: 0.5px solid rgba(0, 0, 0, 0.1);">
                            <div style="display: flex;">
                                <button onclick="closeDeleteConfirmation()" style="flex: 1; background: none; border: none; padding: 16px; font-size: 17px; font-weight: 400; cursor: pointer; color: #007aff; border-right: 0.5px solid rgba(0, 0, 0, 0.1); transition: all 0.2s ease;" 
                                    onmousedown="this.style.background='rgba(0, 122, 255, 0.1)'" 
                                    onmouseup="this.style.background='none'" 
                                    onmouseleave="this.style.background='none'"
                                    ontouchstart="this.style.background='rgba(0, 122, 255, 0.1)'" 
                                    ontouchend="this.style.background='none'">
                                    å–æ¶ˆ
                                </button>
                                <button onclick="confirmDeleteDevice('${deviceId}', ${deviceIndex})" style="flex: 1; background: none; border: none; padding: 16px; font-size: 17px; font-weight: 600; cursor: pointer; color: #ff3b30; transition: all 0.2s ease;" 
                                    onmousedown="this.style.background='rgba(255, 59, 48, 0.1)'" 
                                    onmouseup="this.style.background='none'" 
                                    onmouseleave="this.style.background='none'"
                                    ontouchstart="this.style.background='rgba(255, 59, 48, 0.1)'" 
                                    ontouchend="this.style.background='none'">
                                    åˆ é™¤
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.querySelector('.phone-container').insertAdjacentHTML('beforeend', deleteModalHTML);
        }
        
        function closeDeleteConfirmation() {
            const modal = document.getElementById('deleteConfirmModal');
            if (modal) modal.remove();
        }
        
        function confirmDeleteDevice(deviceId, deviceIndex) {
            // ä»è®¾å¤‡æ•°ç»„ä¸­åˆ é™¤è®¾å¤‡
            const deletedDevice = devices.find(device => device.id === deviceId);
            devices = devices.filter(device => device.id !== deviceId);
            
            // å…³é—­ç¡®è®¤å¼¹çª—
            closeDeleteConfirmation();
            
            // æ›´æ–°è®¾å¤‡æ˜¾ç¤º
            updateDeviceDisplay();
            
            // æ˜¾ç¤ºåˆ é™¤æˆåŠŸæç¤º
            showSuccessMessage(`${deletedDevice.name} å·²åˆ é™¤`);
        }
        
        function showSuccessMessage(message) {
            // æ¸…é™¤ä¹‹å‰çš„æç¤º
            const existingMessage = document.getElementById('successMessage');
            if (existingMessage) existingMessage.remove();
            
            const successHTML = `
                <div id="successMessage" style="position: absolute; top: 100px; left: 50%; transform: translateX(-50%); background: #30d158; color: white; padding: 16px 28px; border-radius: 24px; font-size: 16px; font-weight: 600; z-index: 9999; box-shadow: 0 8px 32px rgba(48, 209, 88, 0.4); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.2);">
                    âœ“ ${message}
                </div>
            `;
            
            document.querySelector('.phone-container').insertAdjacentHTML('beforeend', successHTML);
            
            // 2ç§’åè‡ªåŠ¨æ¶ˆå¤±
            setTimeout(() => {
                const msg = document.getElementById('successMessage');
                if (msg) {
                    msg.style.transform = 'translateX(-50%) translateY(-30px)';
                    msg.style.opacity = '0';
                    setTimeout(() => msg.remove(), 300);
                }
            }, 2000);
        }
        
        // ç½‘ç»œé…ç½®å¼¹çª—
        function showNetworkConfigModal() {
            const modalHTML = `
                <div id="networkConfigModal" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.5); z-index: 2000; display: flex; align-items: center; justify-content: center; animation: fadeIn 0.3s ease;">
                    <div style="background: #ffffff; border-radius: 24px; width: 90%; max-width: 340px; padding: 0; overflow: hidden; position: relative; animation: slideUp 0.3s ease;">
                        <!-- å›¾æ ‡å’Œæ ‡é¢˜ -->
                        <div style="padding: 32px 24px 20px; text-align: center;">
                            <!-- WiFiå›¾æ ‡ -->
                            <div style="width: 72px; height: 72px; background: linear-gradient(135deg, #007aff 0%, #0056b3 100%); border-radius: 20px; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px;">
                                <svg width="36" height="36" fill="white" viewBox="0 0 24 24">
                                    <path d="M1 9l2 2c4.97-4.97 13.03-4.97 18 0l2-2C16.93 2.93 7.08 2.93 1 9zm8 8l3 3 3-3c-1.65-1.66-4.34-1.66-6 0zm-4-4l2 2c2.76-2.76 7.24-2.76 10 0l2-2C15.14 9.14 8.87 9.14 5 13z"/>
                                </svg>
                            </div>
                            
                            <h2 style="font-size: 22px; font-weight: 600; color: #1d1d1f; margin: 0 0 8px 0;">è®¾ç½®ç½‘ç»œè¿æ¥</h2>
                            <p style="font-size: 15px; color: #86868b; margin: 0; line-height: 1.4;">ä¸ºæ–°æ·»åŠ çš„è®¾å¤‡é…ç½®ç½‘ç»œï¼Œç¡®ä¿è®¾å¤‡èƒ½å¤Ÿæ­£å¸¸è”ç½‘è¿è¡Œ</p>
                        </div>
                        
                        <!-- æŒ‰é’®ç»„ -->
                        <div style="padding: 0 24px 24px;">
                            <!-- å‰å¾€è®¾ç½®æŒ‰é’® -->
                            <button onclick="goToNetworkSettings()" style="width: 100%; background: #007aff; color: white; border: none; border-radius: 12px; padding: 16px; font-size: 17px; font-weight: 600; cursor: pointer; margin-bottom: 12px; transition: all 0.2s ease;">
                                å‰å¾€è®¾ç½®
                            </button>
                            
                            <!-- ç¨åè®¾ç½®æŒ‰é’® -->
                            <button onclick="closeNetworkConfigModal()" style="width: 100%; background: rgba(0, 0, 0, 0.04); color: #007aff; border: none; border-radius: 12px; padding: 16px; font-size: 17px; font-weight: 500; cursor: pointer; transition: all 0.2s ease;">
                                ç¨åè®¾ç½®
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            // æ·»åŠ æ ·å¼åŠ¨ç”»
            const style = document.createElement('style');
            style.textContent = `
                @keyframes fadeIn {
                    from { opacity: 0; }
                    to { opacity: 1; }
                }
                @keyframes slideUp {
                    from { transform: translateY(20px); opacity: 0; }
                    to { transform: translateY(0); opacity: 1; }
                }
            `;
            document.head.appendChild(style);
            
            document.querySelector('.phone-container').insertAdjacentHTML('beforeend', modalHTML);
        }
        
        // å…³é—­ç½‘ç»œé…ç½®å¼¹çª—
        function closeNetworkConfigModal() {
            const modal = document.getElementById('networkConfigModal');
            if (modal) {
                modal.style.animation = 'fadeOut 0.3s ease';
                setTimeout(() => {
                    modal.remove();
                }, 300);
            }
        }
        
        // å‰å¾€ç½‘ç»œè®¾ç½®é¡µé¢
        function goToNetworkSettings() {
            closeNetworkConfigModal();
            
            // ç›´æ¥è·³è½¬åˆ°ç½‘ç»œé…ç½®é¡µé¢
            window.location.href = './network-config.html';
        }
        
        // è·³è½¬åˆ°ç½‘ç»œé…ç½®é¡µé¢
        function goToNetworkConfig() {
            window.location.href = './network-config.html';
        }
        
        // æ‰“å¼€ç½‘ç»œè®¾ç½®é¢æ¿ï¼ˆä»è®¾ç½®é¡µé¢ç‚¹å‡»ï¼‰
        function openNetworkSettingsPanel() {
            showNetworkSettingsPage();
        }
        
        // æ˜¾ç¤ºç½‘ç»œè®¾ç½®é¡µé¢
        function showNetworkSettingsPage() {
            const networkPageHTML = `
                <div id="networkSettingsPage" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: #f2f2f7; z-index: 2500; display: flex; flex-direction: column; transform: translateX(100%); transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);">
                    <!-- çŠ¶æ€æ  -->
                    <div class="status-bar">
                        <div class="status-time">13:34</div>
                        <div class="status-icons">
                            <svg width="18" height="18" fill="#1d1d1f" viewBox="0 0 20 20">
                                <path d="M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z"></path>
                            </svg>
                            <svg width="18" height="18" fill="#1d1d1f" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M17.778 8.222c-4.296-4.296-11.26-4.296-15.556 0A1 1 0 01.808 6.808c5.076-5.077 13.308-5.077 18.384 0a1 1 0 01-1.414 1.414zM14.95 11.05a7 7 0 00-9.9 0 1 1 0 01-1.414-1.414 9 9 0 0112.728 0 1 1 0 01-1.414 1.414zM12.12 13.88a3 3 0 00-4.242 0 1 1 0 01-1.415-1.415 5 5 0 017.072 0 1 1 0 01-1.415 1.415zM9 16a1 1 0 011-1v0a1 1 0 110 2v0a1 1 0 01-1-1z"></path>
                            </svg>
                            <div class="battery">
                                <div class="battery-level"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- å¯¼èˆªæ  -->
                    <div style="background: white; border-bottom: 0.5px solid rgba(0, 0, 0, 0.1); padding: 0 20px; height: 44px; display: flex; align-items: center;">
                        <button onclick="closeNetworkSettingsPage()" style="background: none; border: none; padding: 8px; margin-left: -8px; cursor: pointer;">
                            <svg width="24" height="24" fill="#007aff" viewBox="0 0 24 24">
                                <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                            </svg>
                        </button>
                        <div style="flex: 1; text-align: center; font-size: 17px; font-weight: 600;">ç½‘ç»œé…ç½®</div>
                        <div style="width: 40px;"></div>
                    </div>
                    
                    <!-- å†…å®¹åŒºåŸŸ -->
                    <div style="flex: 1; overflow-y: auto; padding: 20px;">
                        <!-- WiFiè®¾ç½®å¡ç‰‡ -->
                        <div style="background: white; border-radius: 12px; padding: 16px; margin-bottom: 20px;">
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px;">
                                <div style="display: flex; align-items: center; gap: 12px;">
                                    <div style="width: 32px; height: 32px; background: #007aff; border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                                        <svg width="18" height="18" fill="white" viewBox="0 0 24 24">
                                            <path d="M1 9l2 2c4.97-4.97 13.03-4.97 18 0l2-2C16.93 2.93 7.08 2.93 1 9zm8 8l3 3 3-3c-1.65-1.66-4.34-1.66-6 0zm-4-4l2 2c2.76-2.76 7.24-2.76 10 0l2-2C15.14 9.14 8.87 9.14 5 13z"/>
                                        </svg>
                                    </div>
                                    <div>
                                        <div style="font-size: 16px; font-weight: 600; color: #1d1d1f;">Wi-Fi</div>
                                        <div style="font-size: 13px; color: #86868b;">å·²è¿æ¥åˆ° Office_5G</div>
                                    </div>
                                </div>
                                <label style="position: relative; display: inline-block; width: 51px; height: 31px;">
                                    <input type="checkbox" checked style="opacity: 0; width: 0; height: 0;">
                                    <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background: #34c759; transition: .4s; border-radius: 31px;">
                                        <span style="position: absolute; content: ''; height: 27px; width: 27px; left: 2px; bottom: 2px; background: white; transition: .4s; border-radius: 50%; box-shadow: 0 2px 4px rgba(0,0,0,0.2); transform: translateX(20px);"></span>
                                    </span>
                                </label>
                            </div>
                            
                            <!-- å¯ç”¨ç½‘ç»œåˆ—è¡¨ -->
                            <div style="border-top: 1px solid #e5e7eb; padding-top: 12px;">
                                <div style="font-size: 13px; color: #86868b; margin-bottom: 12px;">å¯ç”¨ç½‘ç»œ</div>
                                
                                <div onclick="connectToWiFi('Office_5G')" style="display: flex; align-items: center; justify-content: between; padding: 12px; background: #f2f2f7; border-radius: 8px; margin-bottom: 8px; cursor: pointer;">
                                    <div style="flex: 1;">
                                        <div style="font-size: 15px; color: #1d1d1f;">Office_5G</div>
                                        <div style="font-size: 12px; color: #007aff;">å·²è¿æ¥</div>
                                    </div>
                                    <svg width="20" height="20" fill="#86868b" viewBox="0 0 24 24">
                                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                                    </svg>
                                </div>
                                
                                <div onclick="connectToWiFi('Home_Network')" style="display: flex; align-items: center; justify-content: space-between; padding: 12px; border-radius: 8px; margin-bottom: 8px; cursor: pointer; transition: background 0.2s;" onmouseover="this.style.background='#f2f2f7'" onmouseout="this.style.background='transparent'">
                                    <div style="flex: 1;">
                                        <div style="font-size: 15px; color: #1d1d1f;">Home_Network</div>
                                        <div style="font-size: 12px; color: #86868b;">ä¿¡å·å¼º</div>
                                    </div>
                                    <svg width="16" height="16" fill="#c7c7cc" viewBox="0 0 24 24">
                                        <path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"/>
                                    </svg>
                                </div>
                                
                                <div onclick="connectToWiFi('Guest_WiFi')" style="display: flex; align-items: center; justify-content: space-between; padding: 12px; border-radius: 8px; cursor: pointer; transition: background 0.2s;" onmouseover="this.style.background='#f2f2f7'" onmouseout="this.style.background='transparent'">
                                    <div style="flex: 1;">
                                        <div style="font-size: 15px; color: #1d1d1f;">Guest_WiFi</div>
                                        <div style="font-size: 12px; color: #86868b;">ä¿¡å·ä¸­ç­‰</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- è®¾å¤‡ç½‘ç»œä¿¡æ¯ -->
                        <div style="background: white; border-radius: 12px; padding: 16px;">
                            <div style="font-size: 16px; font-weight: 600; color: #1d1d1f; margin-bottom: 16px;">è®¾å¤‡ç½‘ç»œä¿¡æ¯</div>
                            <div style="display: grid; gap: 12px;">
                                <div style="display: flex; justify-content: space-between;">
                                    <span style="color: #86868b; font-size: 14px;">IPåœ°å€</span>
                                    <span style="color: #1d1d1f; font-size: 14px;">192.168.1.128</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span style="color: #86868b; font-size: 14px;">å­ç½‘æ©ç </span>
                                    <span style="color: #1d1d1f; font-size: 14px;">255.255.255.0</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span style="color: #86868b; font-size: 14px;">ç½‘å…³</span>
                                    <span style="color: #1d1d1f; font-size: 14px;">192.168.1.1</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span style="color: #86868b; font-size: 14px;">DNS</span>
                                    <span style="color: #1d1d1f; font-size: 14px;">8.8.8.8</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- åº•éƒ¨æŒ‰é’® -->
                    <div style="padding: 20px; background: white; border-top: 0.5px solid rgba(0, 0, 0, 0.1);">
                        <button onclick="saveNetworkSettings()" style="width: 100%; background: #007aff; color: white; border: none; border-radius: 12px; padding: 16px; font-size: 17px; font-weight: 600; cursor: pointer;">
                            ä¿å­˜è®¾ç½®
                        </button>
                    </div>
                </div>
            `;
            
            document.querySelector('.phone-container').insertAdjacentHTML('beforeend', networkPageHTML);
            
            // æ˜¾ç¤ºé¡µé¢åŠ¨ç”»
            setTimeout(() => {
                document.getElementById('networkSettingsPage').style.transform = 'translateX(0)';
            }, 10);
        }
        
        // å…³é—­ç½‘ç»œè®¾ç½®é¡µé¢
        function closeNetworkSettingsPage() {
            const page = document.getElementById('networkSettingsPage');
            if (page) {
                page.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    page.remove();
                }, 300);
            }
        }
        
        // è¿æ¥åˆ°WiFi
        function connectToWiFi(networkName) {
            if (networkName === 'Home_Network' || networkName === 'Guest_WiFi') {
                // æ˜¾ç¤ºå¯†ç è¾“å…¥æ¡†
                showPasswordPrompt(networkName);
            }
        }
        
        // æ˜¾ç¤ºå¯†ç è¾“å…¥å¼¹çª—
        function showPasswordPrompt(networkName) {
            const promptHTML = `
                <div id="passwordPrompt" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.5); z-index: 3000; display: flex; align-items: center; justify-content: center;">
                    <div style="background: white; border-radius: 14px; width: 90%; max-width: 320px; padding: 20px;">
                        <h3 style="font-size: 17px; font-weight: 600; margin-bottom: 8px;">è¾“å…¥å¯†ç </h3>
                        <p style="font-size: 14px; color: #86868b; margin-bottom: 16px;">è¯·è¾“å…¥ "${networkName}" çš„å¯†ç </p>
                        <input type="password" id="wifiPassword" placeholder="å¯†ç " style="width: 100%; padding: 12px; border: 1px solid #d1d1d6; border-radius: 8px; font-size: 16px; margin-bottom: 16px;">
                        <div style="display: flex; gap: 12px;">
                            <button onclick="cancelPasswordPrompt()" style="flex: 1; padding: 12px; border: 1px solid #d1d1d6; background: white; border-radius: 8px; font-size: 16px; color: #007aff; cursor: pointer;">å–æ¶ˆ</button>
                            <button onclick="confirmWiFiConnection('${networkName}')" style="flex: 1; padding: 12px; border: none; background: #007aff; color: white; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer;">è¿æ¥</button>
                        </div>
                    </div>
                </div>
            `;
            document.querySelector('.phone-container').insertAdjacentHTML('beforeend', promptHTML);
        }
        
        // å–æ¶ˆå¯†ç è¾“å…¥
        function cancelPasswordPrompt() {
            const prompt = document.getElementById('passwordPrompt');
            if (prompt) prompt.remove();
        }
        
        // ç¡®è®¤WiFiè¿æ¥
        function confirmWiFiConnection(networkName) {
            cancelPasswordPrompt();
            showSuccessMessage(`å·²è¿æ¥åˆ° ${networkName}`);
        }
        
        // ä¿å­˜ç½‘ç»œè®¾ç½®
        function saveNetworkSettings() {
            closeNetworkSettingsPage();
            showSuccessMessage('ç½‘ç»œè®¾ç½®å·²ä¿å­˜');
        }
        
        
        // QRæ‰«ç åŠŸèƒ½
        function openQRScanner() {
            const qrPage = document.getElementById('qrScanPage');
            if (qrPage) {
                // é‡ç½®é¡µé¢å†…å®¹ä¸ºåŸå§‹çŠ¶æ€
                resetQRScannerPage();
                
                qrPage.style.display = 'block';
                qrPage.style.transform = 'translateX(0)';
                
                // å¼€å§‹æ¨¡æ‹Ÿæ‰«æ
                setTimeout(() => {
                    simulateQRScan();
                }, 2000);
            }
        }
        
        function resetQRScannerPage() {
            const qrPage = document.getElementById('qrScanPage');
            qrPage.innerHTML = `
                <!-- çŠ¶æ€æ  -->
                <div class="status-bar" style="background: transparent;">
                    <div class="status-time" style="color: white;">13:34</div>
                    <div class="status-icons">
                        <svg width="18" height="18" fill="white" viewBox="0 0 20 20">
                            <path d="M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z"></path>
                        </svg>
                        <svg width="18" height="18" fill="white" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M17.778 8.222c-4.296-4.296-11.26-4.296-15.556 0A1 1 0 01.808 6.808c5.076-5.077 13.308-5.077 18.384 0a1 1 0 01-1.414 1.414zM14.95 11.05a7 7 0 00-9.9 0 1 1 0 01-1.414-1.414 9 9 0 0112.728 0 1 1 0 01-1.414 1.414zM12.12 13.88a3 3 0 00-4.242 0 1 1 0 01-1.415-1.415 5 5 0 017.072 0 1 1 0 01-1.415 1.415zM9 16a1 1 0 011-1v0a1 1 0 110 2v0a1 1 0 01-1-1z"></path>
                        </svg>
                        <div class="battery" style="border-color: white;">
                            <div class="battery-level" style="background: white;"></div>
                        </div>
                    </div>
                </div>
                
                <!-- å¯¼èˆªæ  -->
                <div style="height: 44px; display: flex; align-items: center; padding: 0 20px; background: transparent;">
                    <button onclick="closeQRScanner()" style="background: none; border: none; padding: 8px; margin-left: -8px; cursor: pointer; display: flex; align-items: center; justify-content: center;">
                        <svg width="24" height="24" fill="white" viewBox="0 0 24 24">
                            <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                        </svg>
                    </button>
                    <div style="flex: 1; text-align: center; font-size: 17px; font-weight: 600; color: white;">æ‰«ç æ·»åŠ è®¾å¤‡</div>
                    <div style="width: 40px;"></div>
                </div>
                
                <!-- æ‰«æåŒºåŸŸ -->
                <div style="flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 40px 20px;">
                    <!-- æ‰«ææ¡† -->
                    <div class="qr-scan-frame" style="position: relative; width: 280px; height: 280px;">
                        <!-- æ‰«ææ¡†è¾¹è§’ -->
                        <div style="position: absolute; top: 0; left: 0; width: 40px; height: 40px; border-top: 4px solid #007aff; border-left: 4px solid #007aff; border-radius: 8px 0 0 0;"></div>
                        <div style="position: absolute; top: 0; right: 0; width: 40px; height: 40px; border-top: 4px solid #007aff; border-right: 4px solid #007aff; border-radius: 0 8px 0 0;"></div>
                        <div style="position: absolute; bottom: 0; left: 0; width: 40px; height: 40px; border-bottom: 4px solid #007aff; border-left: 4px solid #007aff; border-radius: 0 0 0 8px;"></div>
                        <div style="position: absolute; bottom: 0; right: 0; width: 40px; height: 40px; border-bottom: 4px solid #007aff; border-right: 4px solid #007aff; border-radius: 0 0 8px 0;"></div>
                        
                        <!-- æ‰«æçº¿åŠ¨ç”» -->
                        <div class="qr-scan-line" style="position: absolute; top: 50px; left: 20px; right: 20px; height: 2px; background: #007aff; box-shadow: 0 0 10px #007aff; animation: qrScan 2s ease-in-out infinite;"></div>
                        
                        <!-- æ¨¡æ‹Ÿæ‘„åƒå¤´é¢„è§ˆ -->
                        <div style="position: absolute; top: 20px; left: 20px; right: 20px; bottom: 20px; background: rgba(255, 255, 255, 0.05); border-radius: 8px;"></div>
                    </div>
                    
                    <!-- æ‰«ææˆåŠŸåŒºåŸŸ -->
                    <div id="qrSuccessArea"></div>
                </div>
            `;
        }
        
        function closeQRScanner() {
            const qrPage = document.getElementById('qrScanPage');
            if (qrPage) {
                qrPage.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    qrPage.style.display = 'none';
                }, 300);
            }
        }
        
        function simulateQRScan() {
            // æ¨¡æ‹Ÿæ‰«æåˆ°è®¾å¤‡äºŒç»´ç 
            const mockQRDevices = [
                { name: 'BEI-QR01', type: 'å‚¨èƒ½ç³»ç»Ÿ', qr: 'BEIENERGY_BAT_001_2024' },
                { name: 'PV-QR02', type: 'å…‰ä¼é€†å˜å™¨', qr: 'BEIENERGY_INV_002_2024' },
                { name: 'EV-QR03', type: 'å……ç”µæ¡©', qr: 'BEIENERGY_CHG_003_2024' }
            ];
            
            const randomDevice = mockQRDevices[Math.floor(Math.random() * mockQRDevices.length)];
            
            // æ˜¾ç¤ºæ‰«ææˆåŠŸçŠ¶æ€
            const successArea = document.getElementById('qrSuccessArea');
            const scanFrame = document.querySelector('.qr-scan-frame');
            
            if (successArea && scanFrame) {
                // åœæ­¢æ‰«æåŠ¨ç”»
                const scanLine = document.querySelector('.qr-scan-line');
                if (scanLine) scanLine.style.animation = 'none';
                
                // æ˜¾ç¤ºæˆåŠŸçŠ¶æ€
                scanFrame.style.borderColor = '#30d158';
                
                // ç«‹å³è‡ªåŠ¨æ·»åŠ è®¾å¤‡
                setTimeout(() => {
                    addQRDeviceDirectly(randomDevice.name, randomDevice.type, randomDevice.qr);
                }, 500);
            }
        }
        
        function addQRDeviceDirectly(deviceName, deviceType, qrCode) {
            const deviceIcons = {
                'å‚¨èƒ½ç³»ç»Ÿ': 'ğŸ”‹',
                'å…‰ä¼é€†å˜å™¨': 'â˜€ï¸',
                'å……ç”µæ¡©': 'âš¡'
            };
            
            const newDevice = {
                id: `device_${Date.now()}`,
                name: deviceName,
                type: deviceType,
                sn: qrCode,
                online: true,
                icon: deviceIcons[deviceType],
                soc: Math.floor(Math.random() * 40) + 60,
                soh: Math.floor(Math.random() * 10) + 90,
                status: Math.random() > 0.5 ? 'å……ç”µ' : 'æ”¾ç”µ',
                networkConfigured: false // æ–°æ·»åŠ çš„è®¾å¤‡é»˜è®¤æœªé…ç½‘
            };
            
            devices.push(newDevice);
            lastAddedDevice = newDevice; // è®°å½•æœ€åæ·»åŠ çš„è®¾å¤‡
            closeQRScanner();
            closeAddDevicePage();
            updateDeviceDisplay();
            
            // æ‰‹åŠ¨åˆ‡æ¢åˆ°è®¾å¤‡é¡µé¢
            const pages = document.querySelectorAll('.page-content');
            pages.forEach(page => page.classList.remove('active'));
            document.getElementById('device').classList.add('active');
            
            // æ˜¾ç¤ºç½‘ç»œé…ç½®å¼¹çª—
            setTimeout(() => {
                showNetworkConfigModal();
            }, 1000);
            
            // æ›´æ–°å¯¼èˆªçŠ¶æ€
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => item.classList.remove('active'));
            document.querySelector('.nav-item:nth-child(3)').classList.add('active');
            
            // æ˜¾ç¤ºæ·»åŠ æˆåŠŸæç¤º - å¢åŠ å»¶è¿Ÿç¡®ä¿é¡µé¢åˆ‡æ¢å®Œæˆ
            setTimeout(() => {
                showSuccessMessage('æ·»åŠ æˆåŠŸ');
            }, 1000);
        }
        
        // è“ç‰™è¿æ¥ç›¸å…³å‡½æ•°
        function openBluetoothModal() {
            openAddDevice();
        }
        
        function closeBluetoothModal() {
            // è¿™ä¸ªå‡½æ•°ä¿ç•™ä»¥å…¼å®¹æ€§ï¼Œä½†å®é™…ä½¿ç”¨ closeAddDevicePage
            closeAddDevicePage();
        }
        
        function connectBMSDevice() {
            const statusEl = document.getElementById('bmsStatus');
            const btnEl = document.getElementById('bmsConnectBtn');
            
            btnEl.textContent = 'è¿æ¥ä¸­...';
            btnEl.disabled = true;
            
            // æ¨¡æ‹Ÿè¿æ¥è¿‡ç¨‹
            setTimeout(() => {
                statusEl.textContent = 'å·²è¿æ¥';
                statusEl.style.color = '#30D158';
                btnEl.textContent = 'å·²è¿æ¥';
                btnEl.style.background = '#30D158';
                btnEl.disabled = true;
                
                // æ˜¾ç¤ºè¿æ¥æˆåŠŸæç¤º
                showToast('BMSè®¾å¤‡è¿æ¥æˆåŠŸ');
            }, 2000);
        }
        
        function connectInverterDevice() {
            const statusEl = document.getElementById('invStatus');
            const btnEl = document.getElementById('invConnectBtn');
            
            btnEl.textContent = 'è¿æ¥ä¸­...';
            btnEl.disabled = true;
            
            // æ¨¡æ‹Ÿè¿æ¥è¿‡ç¨‹
            setTimeout(() => {
                statusEl.textContent = 'å·²è¿æ¥';
                statusEl.style.color = '#30D158';
                btnEl.textContent = 'å·²è¿æ¥';
                btnEl.style.background = '#30D158';
                btnEl.disabled = true;
                
                // æ˜¾ç¤ºè¿æ¥æˆåŠŸæç¤º
                showToast('é€†å˜å™¨è®¾å¤‡è¿æ¥æˆåŠŸ');
            }, 1500);
        }
        
        function showToast(message) {
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(0, 0, 0, 0.8);
                color: white;
                padding: 12px 20px;
                border-radius: 8px;
                font-size: 14px;
                z-index: 10000;
                backdrop-filter: blur(10px);
                -webkit-backdrop-filter: blur(10px);
            `;
            toast.textContent = message;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.parentNode.removeChild(toast);
                }
            }, 2000);
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('åŒ—èƒ½æ™ºèƒ½å…‰ä¼ç®¡ç†ç³»ç»Ÿå·²åŠ è½½');
            
            // æ¨¡æ‹Ÿå®æ—¶æ•°æ®æ›´æ–°
            setInterval(() => {
                const powerValues = document.querySelectorAll('.energy-value');
                if (powerValues.length > 0) {
                    // æ¨¡æ‹Ÿå…‰ä¼å‘ç”µåŠŸç‡å˜åŒ–
                    const currentPower = parseFloat(powerValues[0].textContent);
                    const newPower = (currentPower + (Math.random() - 0.5) * 0.1).toFixed(2);
                    powerValues[0].innerHTML = newPower + '<span class="energy-unit">kW</span>';
                }
            }, 5000);
        });
        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥æ˜¯å¦éœ€è¦è·³è½¬åˆ°ç‰¹å®šé¡µé¢
        window.addEventListener('DOMContentLoaded', function() {
            // æ£€æŸ¥URLä¸­çš„hashå‚æ•°
            const hash = window.location.hash;
            if (hash === '#device') {
                // è‡ªåŠ¨åˆ‡æ¢åˆ°è®¾å¤‡é¡µé¢
                const deviceNavItem = document.querySelector('.nav-item[onclick*="device"]');
                if (deviceNavItem) {
                    deviceNavItem.click();
                }
            }
            
            // æ£€æŸ¥localStorageä¸­çš„é»˜è®¤é¡µé¢è®¾ç½®
            const defaultPage = localStorage.getItem('defaultPage');
            if (defaultPage === 'device' && !hash) {
                // å¦‚æœè®¾ç½®äº†é»˜è®¤é¡µé¢ä¸”URLæ²¡æœ‰hashï¼Œåˆ™è·³è½¬åˆ°è®¾å¤‡é¡µé¢
                const deviceNavItem = document.querySelector('.nav-item[onclick*="device"]');
                if (deviceNavItem) {
                    deviceNavItem.click();
                }
                // æ¸…é™¤é»˜è®¤é¡µé¢è®¾ç½®ï¼Œé¿å…æ¯æ¬¡éƒ½è·³è½¬
                localStorage.removeItem('defaultPage');
            }
        });

        // æ˜¾ç¤ºä½ç½®æƒé™è¯·æ±‚å¼¹çª—
        function showLocationPermissionDialog() {
            // åˆ›å»ºå¼¹çª—å®¹å™¨
            const dialog = document.createElement('div');
            dialog.id = 'locationPermissionDialog';
            dialog.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.6);
                z-index: 3000;
                display: flex;
                align-items: center;
                justify-content: center;
                backdrop-filter: blur(10px);
                -webkit-backdrop-filter: blur(10px);
            `;
            
            // åˆ›å»ºå¼¹çª—å†…å®¹
            const content = document.createElement('div');
            content.style.cssText = `
                background: #f2f2f7;
                border-radius: 14px;
                max-width: 320px;
                width: 90%;
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
                overflow: hidden;
            `;
            
            // æ ‡é¢˜éƒ¨åˆ†
            const header = document.createElement('div');
            header.style.cssText = `
                padding: 20px 20px 12px;
                text-align: center;
                background: white;
            `;
            
            const title = document.createElement('div');
            title.style.cssText = `
                font-size: 17px;
                font-weight: 600;
                color: #000;
                margin-bottom: 8px;
            `;
            title.innerHTML = 'å…è®¸"åŒ—èƒ½BMS"<br>ä½¿ç”¨ä½ çš„ä½ç½®ï¼Ÿ';
            
            const subtitle = document.createElement('div');
            subtitle.style.cssText = `
                font-size: 13px;
                color: #3C3C43;
                line-height: 18px;
                opacity: 0.6;
                margin-top: 8px;
            `;
            subtitle.textContent = 'ä½ç½®æƒé™ç”¨äºå¿«é€Ÿè¿æ¥è®¾å¤‡ã€è¯†åˆ«å®šä½ä»¥åŠå‘ç°é™„è¿‘çš„è®¾å¤‡å’ŒWi-Fiåˆ—è¡¨ã€‚';
            
            header.appendChild(title);
            header.appendChild(subtitle);
            
            // åœ°å›¾é¢„è§ˆéƒ¨åˆ†
            const mapContainer = document.createElement('div');
            mapContainer.style.cssText = `
                height: 160px;
                background: linear-gradient(to bottom, #e8f4f8, #d4e8ee);
                position: relative;
                overflow: hidden;
            `;
            
            // æ·»åŠ ç®€å•çš„åœ°å›¾å…ƒç´ 
            const mapContent = document.createElement('div');
            mapContent.innerHTML = `
                <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
                    <div style="width: 20px; height: 20px; background: #007AFF; border-radius: 50%; box-shadow: 0 0 0 8px rgba(0, 122, 255, 0.2);"></div>
                </div>
                <div style="position: absolute; bottom: 10px; left: 10px; background: white; padding: 4px 8px; border-radius: 4px; font-size: 11px; color: #666;">
                    <span>ğŸ“ å½“å‰ä½ç½®</span>
                </div>
            `;
            mapContainer.appendChild(mapContent);
            
            // æŒ‰é’®å®¹å™¨
            const buttonContainer = document.createElement('div');
            buttonContainer.style.cssText = `
                background: white;
                padding: 0;
            `;
            
            // å…è®¸ä¸€æ¬¡æŒ‰é’®
            const allowOnceBtn = document.createElement('button');
            allowOnceBtn.style.cssText = `
                width: 100%;
                padding: 16px;
                border: none;
                background: white;
                font-size: 17px;
                color: #007AFF;
                cursor: pointer;
                border-bottom: 0.5px solid rgba(60, 60, 67, 0.13);
                transition: background-color 0.2s;
            `;
            allowOnceBtn.textContent = 'å…è®¸ä¸€æ¬¡';
            allowOnceBtn.onmouseover = () => allowOnceBtn.style.background = '#f9f9f9';
            allowOnceBtn.onmouseout = () => allowOnceBtn.style.background = 'white';
            allowOnceBtn.onclick = () => handleLocationPermission('once');
            
            // ä½¿ç”¨Appæ—¶å…è®¸æŒ‰é’®
            const allowWhileUsingBtn = document.createElement('button');
            allowWhileUsingBtn.style.cssText = `
                width: 100%;
                padding: 16px;
                border: none;
                background: white;
                font-size: 17px;
                color: #007AFF;
                cursor: pointer;
                border-bottom: 0.5px solid rgba(60, 60, 67, 0.13);
                transition: background-color 0.2s;
            `;
            allowWhileUsingBtn.textContent = 'ä½¿ç”¨ App æ—¶å…è®¸';
            allowWhileUsingBtn.onmouseover = () => allowWhileUsingBtn.style.background = '#f9f9f9';
            allowWhileUsingBtn.onmouseout = () => allowWhileUsingBtn.style.background = 'white';
            allowWhileUsingBtn.onclick = () => handleLocationPermission('while-using');
            
            // ä¸å…è®¸æŒ‰é’®
            const denyBtn = document.createElement('button');
            denyBtn.style.cssText = `
                width: 100%;
                padding: 16px;
                border: none;
                background: white;
                font-size: 17px;
                color: #007AFF;
                cursor: pointer;
                transition: background-color 0.2s;
            `;
            denyBtn.textContent = 'ä¸å…è®¸';
            denyBtn.onmouseover = () => denyBtn.style.background = '#f9f9f9';
            denyBtn.onmouseout = () => denyBtn.style.background = 'white';
            denyBtn.onclick = () => handleLocationPermission('denied');
            
            buttonContainer.appendChild(allowOnceBtn);
            buttonContainer.appendChild(allowWhileUsingBtn);
            buttonContainer.appendChild(denyBtn);
            
            content.appendChild(header);
            content.appendChild(mapContainer);
            content.appendChild(buttonContainer);
            dialog.appendChild(content);
            document.body.appendChild(dialog);
        }
        
        // å¤„ç†ä½ç½®æƒé™é€‰æ‹©
        function handleLocationPermission(permission) {
            const dialog = document.getElementById('locationPermissionDialog');
            if (dialog) {
                document.body.removeChild(dialog);
            }
            
            // ä¿å­˜æƒé™é€‰æ‹©
            localStorage.setItem('locationPermission', permission);
            
            switch(permission) {
                case 'once':
                    showToast('å·²å…è®¸ä½¿ç”¨ä½ç½®ï¼ˆä»…é™æœ¬æ¬¡ï¼‰');
                    // æ˜¾ç¤ºè“ç‰™æƒé™å¼¹çª—
                    setTimeout(() => {
                        showBluetoothPermissionDialog();
                    }, 1000);
                    // æœ¬æ¬¡ä½¿ç”¨åæ¸…é™¤æƒé™
                    setTimeout(() => {
                        localStorage.removeItem('locationPermission');
                    }, 30000); // 30ç§’åæ¸…é™¤
                    break;
                    
                case 'while-using':
                    showToast('å·²å…è®¸åœ¨ä½¿ç”¨Appæ—¶è®¿é—®ä½ç½®');
                    // æ˜¾ç¤ºè“ç‰™æƒé™å¼¹çª—
                    setTimeout(() => {
                        showBluetoothPermissionDialog();
                    }, 1000);
                    break;
                    
                case 'denied':
                    showToast('å·²æ‹’ç»ä½ç½®æƒé™');
                    // ä¸ç»§ç»­è“ç‰™è¿æ¥
                    break;
            }
        }
        
        // æ˜¾ç¤ºè“ç‰™æƒé™è¯·æ±‚å¼¹çª—
        function showBluetoothPermissionDialog() {
            // åˆ›å»ºå¼¹çª—å®¹å™¨
            const dialog = document.createElement('div');
            dialog.id = 'bluetoothPermissionDialog';
            dialog.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.6);
                z-index: 3000;
                display: flex;
                align-items: center;
                justify-content: center;
                backdrop-filter: blur(10px);
                -webkit-backdrop-filter: blur(10px);
            `;
            
            // åˆ›å»ºå¼¹çª—å†…å®¹
            const content = document.createElement('div');
            content.style.cssText = `
                background: white;
                border-radius: 14px;
                max-width: 320px;
                width: 90%;
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
                overflow: hidden;
            `;
            
            // å†…å®¹éƒ¨åˆ†
            const body = document.createElement('div');
            body.style.cssText = `
                padding: 32px 20px 20px;
                text-align: center;
                background: white;
            `;
            
            // è“ç‰™å›¾æ ‡
            const iconContainer = document.createElement('div');
            iconContainer.style.cssText = `
                margin-bottom: 20px;
            `;
            iconContainer.innerHTML = `
                <svg width="56" height="56" viewBox="0 0 56 56" fill="none" style="margin: 0 auto;">
                    <rect width="56" height="56" rx="14" fill="#007AFF" fill-opacity="0.1"/>
                    <path d="M28 16L35 23L30 28L35 33L28 40V28L23 33L21 31L26 26L21 21L23 19L28 24V16Z" 
                          stroke="#007AFF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                </svg>
            `;
            
            const title = document.createElement('div');
            title.style.cssText = `
                font-size: 17px;
                font-weight: 600;
                color: #000;
                margin-bottom: 12px;
                line-height: 24px;
            `;
            title.innerHTML = '"åŒ—èƒ½BMS"æƒ³è¦ä½¿ç”¨è“ç‰™';
            
            const message = document.createElement('div');
            message.style.cssText = `
                font-size: 13px;
                color: #3C3C43;
                opacity: 0.6;
                line-height: 18px;
                margin-bottom: 4px;
            `;
            message.textContent = 'è¿æ¥é€†å˜å™¨æ—¶éœ€è¦æ‰“å¼€è“ç‰™ã€‚è¯·å…è®¸"åŒ—èƒ½BMS"ä½¿ç”¨è“ç‰™æ¥å‘ç°ã€è¿æ¥é™„è¿‘çš„è®¾å¤‡ã€‚';
            
            body.appendChild(iconContainer);
            body.appendChild(title);
            body.appendChild(message);
            
            // æŒ‰é’®å®¹å™¨
            const buttonContainer = document.createElement('div');
            buttonContainer.style.cssText = `
                display: flex;
                border-top: 0.5px solid rgba(60, 60, 67, 0.13);
            `;
            
            // ä¸å…è®¸æŒ‰é’®
            const denyBtn = document.createElement('button');
            denyBtn.style.cssText = `
                flex: 1;
                padding: 17px;
                border: none;
                background: white;
                font-size: 17px;
                color: #007AFF;
                cursor: pointer;
                border-right: 0.5px solid rgba(60, 60, 67, 0.13);
                transition: background-color 0.2s;
            `;
            denyBtn.textContent = 'ä¸å…è®¸';
            denyBtn.onmouseover = () => denyBtn.style.background = '#f9f9f9';
            denyBtn.onmouseout = () => denyBtn.style.background = 'white';
            denyBtn.onclick = () => handleBluetoothPermission('denied');
            
            // å¥½æŒ‰é’®ï¼ˆå…è®¸ï¼‰
            const allowBtn = document.createElement('button');
            allowBtn.style.cssText = `
                flex: 1;
                padding: 17px;
                border: none;
                background: white;
                font-size: 17px;
                color: #007AFF;
                font-weight: 600;
                cursor: pointer;
                transition: background-color 0.2s;
            `;
            allowBtn.textContent = 'å¥½';
            allowBtn.onmouseover = () => allowBtn.style.background = '#f9f9f9';
            allowBtn.onmouseout = () => allowBtn.style.background = 'white';
            allowBtn.onclick = () => handleBluetoothPermission('allowed');
            
            buttonContainer.appendChild(denyBtn);
            buttonContainer.appendChild(allowBtn);
            
            content.appendChild(body);
            content.appendChild(buttonContainer);
            dialog.appendChild(content);
            document.body.appendChild(dialog);
        }
        
        // å¤„ç†è“ç‰™æƒé™é€‰æ‹©
        function handleBluetoothPermission(permission) {
            const dialog = document.getElementById('bluetoothPermissionDialog');
            if (dialog) {
                document.body.removeChild(dialog);
            }
            
            // ä¿å­˜è“ç‰™æƒé™é€‰æ‹©
            localStorage.setItem('bluetoothPermission', permission);
            
            if (permission === 'allowed') {
                showToast('å·²å…è®¸ä½¿ç”¨è“ç‰™');
                // ç»§ç»­æ·»åŠ è®¾å¤‡æµç¨‹
                setTimeout(() => {
                    showAddDevicePageDirectly();
                }, 500);
            } else {
                showToast('å·²æ‹’ç»è“ç‰™æƒé™');
            }
        }
    </script>
</body>
</html>