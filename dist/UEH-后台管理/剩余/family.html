<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Management</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">

    <!-- Tailwind 配置 - 苹果风格 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#0071e3',
                        secondary: '#1d1d1f',
                        tertiary: '#86868b',
                        light: '#f5f5f7',
                        success: '#34c759',
                        warning: '#ff9500',
                        danger: '#ff3b30',
                        border: '#d2d2d7',
                    },
                    fontFamily: {
                        sans: ['-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'Helvetica Neue', 'Arial', 'sans-serif'],
                    },
                    boxShadow: {
                        'apple': '0 2px 10px rgba(0, 0, 0, 0.05), 0 1px 3px rgba(0, 0, 0, 0.03)',
                        'apple-hover': '0 5px 15px rgba(0, 0, 0, 0.08), 0 2px 5px rgba(0, 0, 0, 0.05)',
                    }
                },
            }
        }
    </script>

    <!-- 自定义工具类 -->
    <style type="text/tailwindcss">
        @layer utilities {
            .card-apple {
                @apply bg-white/90 backdrop-blur-sm rounded-xl shadow-apple overflow-hidden transition-all duration-300 hover:shadow-apple-hover;
            }
            .btn-apple {
                @apply bg-primary text-white font-medium py-2.5 px-4 rounded-full shadow-sm transition-all duration-200 hover:bg-primary/90 active:bg-primary/80;
            }
            .btn-outline-black {
                @apply border border-black text-black font-medium py-2.5 px-4 rounded-full shadow-sm transition-all duration-200 hover:bg-black/5 active:bg-black/10;
            }
            .input-apple {
                @apply w-full px-4 py-3 bg-light border border-border rounded-lg transition-all duration-200 focus:ring-1 focus:ring-primary focus:border-primary focus:outline-none;
            }
        }
    </style>

    <style>
        body {
            background: linear-gradient(135deg, #f8f9fa 0%, #f5f5f7 100%);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            position: relative;
            overflow-x: hidden;
        }
        
        body::before,
        body::after {
            content: '';
            position: fixed;
            border-radius: 50%;
            z-index: -1;
            filter: blur(50px);
            opacity: 0.15;
        }
        
        body::before {
            width: 500px;
            height: 500px;
            background: #0071e3;
            top: -250px;
            right: -250px;
        }
        
        body::after {
            width: 600px;
            height: 600px;
            background: #34c759;
            bottom: -300px;
            left: -300px;
        }
        
        html {
            scroll-behavior: smooth;
        }
        
        .sidebar {
            transition: transform 0.3s ease;
        }
        
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }
            .sidebar.show {
                transform: translateX(0);
            }
        }
        
        .lang-selector {
            position: relative;
        }
        .lang-dropdown {
            display: none;
            position: absolute;
            right: 0;
            z-index: 10;
            margin-top: 0.5rem;
            min-width: 8rem;
            background: white;
            border-radius: 0.5rem;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }
        .lang-dropdown.show {
            display: block;
        }
    </style>
</head>
<body class="min-h-screen font-sans text-secondary flex">
    <!-- 侧边栏 -->
    <aside class="sidebar w-64 bg-white shadow-sm fixed md:relative h-full z-40">
        <div class="p-6 border-b border-border">
            <img src="logo_副本.png" alt="Logo" class="h-8 max-w-[150px] object-contain">
        </div>
        <nav class="p-4">
            <ul class="space-y-2">
                <li>
                    <a href="home.html" class="flex items-center gap-3 px-4 py-3 hover:bg-gray-100 rounded-lg transition-colors">
                        <i class="fa fa-home"></i>
                        <span data-i18n="nav_home">首页</span>
                    </a>
                </li>
                <li>
                    <a href="admin.html" class="flex items-center gap-3 px-4 py-3 hover:bg-gray-100 rounded-lg transition-colors">
                        <i class="fa fa-shield"></i>
                        <span data-i18n="auth_management">授权管理</span>
                    </a>
                </li>
                <li>
                    <a href="profit.html" class="flex items-center gap-3 px-4 py-3 hover:bg-gray-100 rounded-lg transition-colors">
                        <i class="fa fa-line-chart"></i>
                        <span data-i18n="nav_profit">利润分析</span>
                    </a>
                </li>
                <li>
                    <a href="#" id="family-link" class="flex items-center gap-3 px-4 py-3 bg-black text-white rounded-lg cursor-default">
                        <i class="fa fa-users"></i>
                        <span data-i18n="nav_family">家庭管理</span>
                    </a>
                </li>
                <li>
                    <a href="analysis.html" class="flex items-center gap-3 px-4 py-3 hover:bg-gray-100 rounded-lg transition-colors">
                        <i class="fa fa-bar-chart"></i>
                        <span data-i18n="nav_analysis">数据分析</span>
                    </a>
                </li>
                <li>
                    <a href="organization.html" class="flex items-center gap-3 px-4 py-3 hover:bg-gray-100 rounded-lg transition-colors">
                        <i class="fa fa-sitemap"></i>
                        <span data-i18n="nav_organization">组织管理</span>
                    </a>
                </li>
                <li>
                    <a href="push-strategy.html" class="flex items-center gap-3 px-4 py-3 hover:bg-gray-100 rounded-lg transition-colors">
                        <i class="fa fa-bullhorn"></i>
                        <span data-i18n="nav_push_strategy">推送策略</span>
                    </a>
                </li>
                <li>
                    <a href="operation-log.html" class="flex items-center gap-3 px-4 py-3 hover:bg-gray-100 rounded-lg transition-colors">
                        <i class="fa fa-history"></i>
                        <span data-i18n="nav_operation_log">操作日志</span>
                    </a>
                </li>
                <li>
                    <a href="message-center.html" class="flex items-center gap-3 px-4 py-3 hover:bg-gray-100 rounded-lg transition-colors">
                        <i class="fa fa-bell"></i>
                        <span data-i18n="nav_message_center">消息中心</span>
                    </a>
                </li>
                <li>
                    <a href="settings.html" class="flex items-center gap-3 px-4 py-3 hover:bg-gray-100 rounded-lg transition-colors">
                        <i class="fa fa-cog"></i>
                        <span data-i18n="nav_settings">设置</span>
                    </a>
                </li>
            </ul>
        </nav>
    </aside>

    <!-- 主内容区 -->
    <div class="flex-1 flex flex-col">
        <!-- 头部导航 -->
        <header class="bg-white shadow-sm sticky top-0 z-30">
            <div class="px-6 py-4 flex justify-between items-center">
                <div class="flex items-center gap-4">
                    <button id="menu-toggle" class="md:hidden text-secondary">
                        <i class="fa fa-bars text-xl"></i>
                    </button>
                    <h1 class="text-xl font-semibold" data-i18n="family_management">家庭管理</h1>
                </div>
                <div class="flex items-center gap-3">
                    <div class="lang-selector">
                        <button id="lang-toggle-btn" class="flex items-center px-3 py-2 rounded-full bg-light hover:bg-gray-200 transition-colors">
                            <span id="current-lang" class="mr-1">中文</span>
                            <i class="fa fa-chevron-down text-xs"></i>
                        </button>
                        <div id="lang-dropdown" class="lang-dropdown">
                            <button class="lang-option w-full text-left px-4 py-3 hover:bg-light transition-colors" data-lang="zh">中文</button>
                            <button class="lang-option w-full text-left px-4 py-3 hover:bg-light transition-colors" data-lang="en">English</button>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- 主内容 -->
        <main class="flex-1 p-6 space-y-6">
            <!-- 统计卡片 -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="card-apple p-6">
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 bg-primary/10 rounded-xl flex items-center justify-center">
                            <i class="fa fa-home text-primary text-lg"></i>
                        </div>
                        <div class="flex-1">
                            <p class="text-2xl font-bold">486</p>
                            <p class="text-tertiary text-sm" data-i18n="total_families">总家庭数</p>
                        </div>
                    </div>
                </div>

                <div class="card-apple p-6">
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 bg-success/10 rounded-xl flex items-center justify-center">
                            <i class="fa fa-check-circle text-success text-lg"></i>
                        </div>
                        <div class="flex-1">
                            <p class="text-2xl font-bold">423</p>
                            <p class="text-tertiary text-sm" data-i18n="active_families">活跃家庭</p>
                        </div>
                    </div>
                </div>

                <div class="card-apple p-6">
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 bg-warning/10 rounded-xl flex items-center justify-center">
                            <i class="fa fa-battery-3 text-warning text-lg"></i>
                        </div>
                        <div class="flex-1">
                            <p class="text-2xl font-bold">1,247</p>
                            <p class="text-tertiary text-sm" data-i18n="total_devices">总设备数</p>
                        </div>
                    </div>
                </div>

                <div class="card-apple p-6">
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 bg-danger/10 rounded-xl flex items-center justify-center">
                            <i class="fa fa-bolt text-danger text-lg"></i>
                        </div>
                        <div class="flex-1">
                            <p class="text-2xl font-bold">2.8 MW</p>
                            <p class="text-tertiary text-sm" data-i18n="total_capacity">总容量</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 搜索和筛选 -->
            <div class="card-apple p-6">
                <h3 class="text-lg font-semibold mb-4" data-i18n="search_filters">搜索与筛选</h3>
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div>
                        <input type="text" id="family-search" placeholder="搜索家庭名称" class="input-apple" data-i18n-placeholder="search_family">
                    </div>
                    <div>
                        <select class="input-apple" id="status-filter">
                            <option value="" data-i18n="all_status">所有状态</option>
                            <option value="active" data-i18n="active">活跃</option>
                            <option value="inactive" data-i18n="inactive">非活跃</option>
                            <option value="suspended" data-i18n="suspended">暂停</option>
                        </select>
                    </div>
                    <div>
                        <select class="input-apple" id="region-filter">
                            <option value="" data-i18n="all_regions">所有地区</option>
                            <option value="nsw">新南威尔士州</option>
                            <option value="vic">维多利亚州</option>
                            <option value="qld">昆士兰州</option>
                            <option value="wa">西澳大利亚州</option>
                        </select>
                    </div>
                    <div class="flex gap-2">
                        <button class="btn-outline-black flex-1" onclick="resetFilters()">
                            <i class="fa fa-refresh mr-2"></i>
                            <span data-i18n="reset">重置</span>
                        </button>
                        <button class="btn-apple flex-1" onclick="addFamily()">
                            <i class="fa fa-plus mr-2"></i>
                            <span data-i18n="add_family">添加家庭</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- 家庭列表 -->
            <div class="card-apple">
                <div class="p-4 border-b border-border">
                    <div class="flex justify-between items-center">
                        <h3 class="text-lg font-semibold" data-i18n="family_list">家庭列表</h3>
                        <div class="flex gap-2">
                            <button class="btn-outline-black" onclick="exportData()">
                                <i class="fa fa-download mr-2"></i>
                                <span data-i18n="export">导出</span>
                            </button>
                            <button class="btn-outline-black" onclick="refreshData()">
                                <i class="fa fa-refresh mr-2"></i>
                                <span data-i18n="refresh">刷新</span>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-light">
                            <tr>
                                <th class="px-4 py-3 text-left text-sm font-medium text-tertiary">
                                    <input type="checkbox" id="select-all" class="rounded">
                                </th>
                                <th class="px-4 py-3 text-left text-sm font-medium text-tertiary" data-i18n="family_name">家庭名称</th>
                                <th class="px-4 py-3 text-left text-sm font-medium text-tertiary" data-i18n="contact_person">联系人</th>
                                <th class="px-4 py-3 text-left text-sm font-medium text-tertiary" data-i18n="phone">电话</th>
                                <th class="px-4 py-3 text-left text-sm font-medium text-tertiary" data-i18n="address">地址</th>
                                <th class="px-4 py-3 text-left text-sm font-medium text-tertiary" data-i18n="devices">设备数</th>
                                <th class="px-4 py-3 text-left text-sm font-medium text-tertiary" data-i18n="capacity">容量</th>
                                <th class="px-4 py-3 text-left text-sm font-medium text-tertiary" data-i18n="status">状态</th>
                                <th class="px-4 py-3 text-left text-sm font-medium text-tertiary" data-i18n="join_date">加入日期</th>
                                <th class="px-4 py-3 text-left text-sm font-medium text-tertiary" data-i18n="operations">操作</th>
                            </tr>
                        </thead>
                        <tbody id="family-table-body">
                            <!-- 动态生成的数据 -->
                        </tbody>
                    </table>
                </div>
                <!-- 分页 -->
                <div class="p-4 border-t border-border flex justify-between items-center">
                    <div class="text-sm text-tertiary">
                        <span data-i18n="showing">显示</span> <span id="showing-range">1-10</span> <span data-i18n="of">共</span> <span id="total-records">486</span> <span data-i18n="records">条记录</span>
                    </div>
                    <div class="flex gap-2">
                        <button id="prev-page" class="px-3 py-1 rounded-lg border border-border hover:bg-light transition-colors">
                            <i class="fa fa-chevron-left"></i>
                        </button>
                        <span class="px-3 py-1" id="page-info">1 / 49</span>
                        <button id="next-page" class="px-3 py-1 rounded-lg border border-border hover:bg-light transition-colors">
                            <i class="fa fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- 家庭详情模态框 -->
    <div id="family-modal" class="fixed inset-0 bg-black/70 z-50 flex items-center justify-center hidden">
        <div class="bg-white rounded-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden">
            <div class="p-5 border-b border-border flex justify-between items-center">
                <h3 class="text-lg font-semibold" data-i18n="family_details">家庭详情</h3>
                <button id="close-family-modal" class="text-tertiary hover:text-secondary transition-colors p-1">
                    <i class="fa fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-5 overflow-y-auto max-h-[70vh]" id="family-modal-content">
                <!-- 详情内容将通过JavaScript动态添加 -->
            </div>
        </div>
    </div>

    <script>
        const translations = {
            zh: {
                family_management: '家庭管理',
                total_families: '总家庭数',
                active_families: '活跃家庭',
                total_devices: '总设备数',
                total_capacity: '总容量',
                search_filters: '搜索与筛选',
                search_family: '搜索家庭名称',
                all_status: '所有状态',
                active: '活跃',
                inactive: '非活跃',
                suspended: '暂停',
                all_regions: '所有地区',
                reset: '重置',
                add_family: '添加家庭',
                family_list: '家庭列表',
                export: '导出',
                refresh: '刷新',
                family_name: '家庭名称',
                contact_person: '联系人',
                phone: '电话',
                address: '地址',
                devices: '设备数',
                capacity: '容量',
                status: '状态',
                join_date: '加入日期',
                operations: '操作',
                view: '查看',
                edit: '编辑',
                suspend: '暂停',
                activate: '激活',
                showing: '显示',
                of: '共',
                records: '条记录',
                family_details: '家庭详情',
                nav_home: '首页',
                auth_management: '授权管理',
                nav_profit: '利润分析',
                nav_family: '家庭管理',
                nav_analysis: '数据分析',
                nav_organization: '组织管理',
                nav_push_strategy: '推送策略',
                nav_operation_log: '操作日志',
                nav_message_center: '消息中心',
                nav_settings: '设置'
            },
            en: {
                family_management: 'Family Management',
                total_families: 'Total Families',
                active_families: 'Active Families',
                total_devices: 'Total Devices',
                total_capacity: 'Total Capacity',
                search_filters: 'Search & Filters',
                search_family: 'Search family name',
                all_status: 'All Status',
                active: 'Active',
                inactive: 'Inactive',
                suspended: 'Suspended',
                all_regions: 'All Regions',
                reset: 'Reset',
                add_family: 'Add Family',
                family_list: 'Family List',
                export: 'Export',
                refresh: 'Refresh',
                family_name: 'Family Name',
                contact_person: 'Contact Person',
                phone: 'Phone',
                address: 'Address',
                devices: 'Devices',
                capacity: 'Capacity',
                status: 'Status',
                join_date: 'Join Date',
                operations: 'Operations',
                view: 'View',
                edit: 'Edit',
                suspend: 'Suspend',
                activate: 'Activate',
                showing: 'Showing',
                of: 'of',
                records: 'records',
                family_details: 'Family Details',
                nav_home: 'Home',
                auth_management: 'Authorization Management',
                nav_profit: 'Profit Analysis',
                nav_family: 'Family Management',
                nav_analysis: 'Data Analysis',
                nav_organization: 'Organization Management',
                nav_push_strategy: 'Push Strategy',
                nav_operation_log: 'Operation Log',
                nav_message_center: 'Message Center',
                nav_settings: 'Settings'
            }
        };

        let currentLang = localStorage.getItem('language') || 'zh';
        let currentPage = 1;
        const pageSize = 10;

        // 模拟家庭数据
        const familyData = [
            {
                id: 1,
                name: 'Johnson家庭',
                contact: 'David Johnson',
                phone: '+61 2 9876 5432',
                address: '123 Main St, Sydney NSW 2000',
                devices: 3,
                capacity: '15.6 kW',
                status: 'active',
                joinDate: '2023-08-15'
            },
            {
                id: 2,
                name: 'Smith家庭',
                contact: 'Sarah Smith',
                phone: '+61 3 8765 4321',
                address: '456 Queen St, Melbourne VIC 3000',
                devices: 2,
                capacity: '10.4 kW',
                status: 'active',
                joinDate: '2023-09-22'
            },
            {
                id: 3,
                name: 'Williams家庭',
                contact: 'Michael Williams',
                phone: '+61 7 7654 3210',
                address: '789 King St, Brisbane QLD 4000',
                devices: 4,
                capacity: '20.8 kW',
                status: 'inactive',
                joinDate: '2023-07-10'
            },
            {
                id: 4,
                name: 'Brown家庭',
                contact: 'Emma Brown',
                phone: '+61 8 6543 2109',
                address: '321 Collins St, Perth WA 6000',
                devices: 1,
                capacity: '5.2 kW',
                status: 'suspended',
                joinDate: '2023-10-05'
            },
            {
                id: 5,
                name: 'Davis家庭',
                contact: 'James Davis',
                phone: '+61 2 5432 1098',
                address: '654 George St, Sydney NSW 2001',
                devices: 3,
                capacity: '16.2 kW',
                status: 'active',
                joinDate: '2023-11-18'
            }
        ];

        function changeLanguage(lang) {
            currentLang = lang;
            localStorage.setItem('language', lang);
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (translations[lang][key]) {
                    el.textContent = translations[lang][key];
                }
            });
            
            // 更新placeholder
            const searchInput = document.getElementById('family-search');
            if (searchInput) {
                searchInput.placeholder = lang === 'zh' ? '搜索家庭名称' : 'Search family name';
            }
            
            document.getElementById('current-lang').textContent = lang === 'zh' ? '中文' : 'English';
            renderFamilyTable();
        }

        function init() {
            changeLanguage(currentLang);
            renderFamilyTable();
            initEventListeners();
        }

        function renderFamilyTable() {
            const tbody = document.getElementById('family-table-body');
            const startIndex = (currentPage - 1) * pageSize;
            const endIndex = Math.min(startIndex + pageSize, familyData.length);
            const pageData = familyData.slice(startIndex, endIndex);

            tbody.innerHTML = pageData.map(family => `
                <tr class="border-b border-border hover:bg-light/50 transition-colors">
                    <td class="px-4 py-3">
                        <input type="checkbox" class="rounded" data-id="${family.id}">
                    </td>
                    <td class="px-4 py-3 text-sm font-medium">${family.name}</td>
                    <td class="px-4 py-3 text-sm">${family.contact}</td>
                    <td class="px-4 py-3 text-sm">${family.phone}</td>
                    <td class="px-4 py-3 text-sm">${family.address}</td>
                    <td class="px-4 py-3 text-sm">${family.devices}</td>
                    <td class="px-4 py-3 text-sm">${family.capacity}</td>
                    <td class="px-4 py-3">
                        <span class="px-2 py-1 text-xs rounded-full ${getStatusClass(family.status)}">
                            ${translations[currentLang][family.status]}
                        </span>
                    </td>
                    <td class="px-4 py-3 text-sm">${family.joinDate}</td>
                    <td class="px-4 py-3">
                        <div class="flex gap-2">
                            <button onclick="viewFamily(${family.id})" class="text-xs px-3 py-1 text-primary hover:bg-primary/10 rounded transition-colors">
                                ${translations[currentLang].view}
                            </button>
                            <button onclick="editFamily(${family.id})" class="text-xs px-3 py-1 text-success hover:bg-success/10 rounded transition-colors">
                                ${translations[currentLang].edit}
                            </button>
                            ${family.status === 'active' ? 
                                `<button onclick="suspendFamily(${family.id})" class="text-xs px-3 py-1 text-warning hover:bg-warning/10 rounded transition-colors">
                                    ${translations[currentLang].suspend}
                                </button>` :
                                `<button onclick="activateFamily(${family.id})" class="text-xs px-3 py-1 text-success hover:bg-success/10 rounded transition-colors">
                                    ${translations[currentLang].activate}
                                </button>`
                            }
                        </div>
                    </td>
                </tr>
            `).join('');

            updatePagination();
        }

        function getStatusClass(status) {
            switch(status) {
                case 'active': return 'bg-success/10 text-success';
                case 'inactive': return 'bg-tertiary/10 text-tertiary';
                case 'suspended': return 'bg-warning/10 text-warning';
                default: return 'bg-tertiary/10 text-tertiary';
            }
        }

        function updatePagination() {
            const totalPages = Math.ceil(familyData.length / pageSize);
            const startIndex = (currentPage - 1) * pageSize + 1;
            const endIndex = Math.min(currentPage * pageSize, familyData.length);
            
            document.getElementById('showing-range').textContent = `${startIndex}-${endIndex}`;
            document.getElementById('total-records').textContent = familyData.length;
            document.getElementById('page-info').textContent = `${currentPage} / ${totalPages}`;
            
            document.getElementById('prev-page').disabled = currentPage === 1;
            document.getElementById('next-page').disabled = currentPage >= totalPages;
        }

        function viewFamily(id) {
            const family = familyData.find(f => f.id === id);
            if (!family) return;

            const modal = document.getElementById('family-modal');
            const content = document.getElementById('family-modal-content');

            content.innerHTML = `
                <div class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="space-y-4">
                            <h4 class="font-semibold text-lg">基本信息</h4>
                            <div class="space-y-3">
                                <div>
                                    <label class="text-sm text-tertiary">家庭名称</label>
                                    <p class="font-medium">${family.name}</p>
                                </div>
                                <div>
                                    <label class="text-sm text-tertiary">联系人</label>
                                    <p class="font-medium">${family.contact}</p>
                                </div>
                                <div>
                                    <label class="text-sm text-tertiary">电话</label>
                                    <p class="font-medium">${family.phone}</p>
                                </div>
                                <div>
                                    <label class="text-sm text-tertiary">地址</label>
                                    <p class="font-medium">${family.address}</p>
                                </div>
                            </div>
                        </div>
                        <div class="space-y-4">
                            <h4 class="font-semibold text-lg">系统信息</h4>
                            <div class="space-y-3">
                                <div>
                                    <label class="text-sm text-tertiary">设备数量</label>
                                    <p class="font-medium">${family.devices} 台</p>
                                </div>
                                <div>
                                    <label class="text-sm text-tertiary">总容量</label>
                                    <p class="font-medium">${family.capacity}</p>
                                </div>
                                <div>
                                    <label class="text-sm text-tertiary">状态</label>
                                    <p class="font-medium">
                                        <span class="px-2 py-1 text-xs rounded-full ${getStatusClass(family.status)}">
                                            ${translations[currentLang][family.status]}
                                        </span>
                                    </p>
                                </div>
                                <div>
                                    <label class="text-sm text-tertiary">加入日期</label>
                                    <p class="font-medium">${family.joinDate}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="border-t border-border pt-6">
                        <h4 class="font-semibold text-lg mb-4">设备详情</h4>
                        <div class="space-y-2">
                            <div class="bg-light p-3 rounded-lg flex justify-between items-center">
                                <div>
                                    <p class="font-medium">Tesla Powerwall 2</p>
                                    <p class="text-sm text-tertiary">13.5 kWh | 安装日期: 2023-08-15</p>
                                </div>
                                <span class="text-success text-sm">在线</span>
                            </div>
                            <div class="bg-light p-3 rounded-lg flex justify-between items-center">
                                <div>
                                    <p class="font-medium">Solar Inverter</p>
                                    <p class="text-sm text-tertiary">10 kW | 安装日期: 2023-08-15</p>
                                </div>
                                <span class="text-success text-sm">在线</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            modal.classList.remove('hidden');
        }

        function editFamily(id) {
            console.log('编辑家庭:', id);
        }

        function suspendFamily(id) {
            console.log('暂停家庭:', id);
        }

        function activateFamily(id) {
            console.log('激活家庭:', id);
        }

        function addFamily() {
            console.log('添加新家庭');
        }

        function resetFilters() {
            document.getElementById('family-search').value = '';
            document.getElementById('status-filter').value = '';
            document.getElementById('region-filter').value = '';
            renderFamilyTable();
        }

        function exportData() {
            console.log('导出数据');
        }

        function refreshData() {
            renderFamilyTable();
        }

        function initEventListeners() {
            // 语言切换
            const langToggleBtn = document.getElementById('lang-toggle-btn');
            const langDropdown = document.getElementById('lang-dropdown');
            
            langToggleBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                langDropdown.classList.toggle('show');
            });
            
            document.querySelectorAll('.lang-option').forEach(option => {
                option.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const lang = this.getAttribute('data-lang');
                    changeLanguage(lang);
                    langDropdown.classList.remove('show');
                });
            });
            
            document.addEventListener('click', function() {
                langDropdown.classList.remove('show');
            });

            // 移动端菜单切换
            document.getElementById('menu-toggle').addEventListener('click', function() {
                document.querySelector('.sidebar').classList.toggle('show');
            });

            // 关闭模态框
            document.getElementById('close-family-modal').addEventListener('click', function() {
                document.getElementById('family-modal').classList.add('hidden');
            });

            document.getElementById('family-modal').addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.add('hidden');
                }
            });

            // 分页
            document.getElementById('prev-page').addEventListener('click', function() {
                if (currentPage > 1) {
                    currentPage--;
                    renderFamilyTable();
                }
            });

            document.getElementById('next-page').addEventListener('click', function() {
                const totalPages = Math.ceil(familyData.length / pageSize);
                if (currentPage < totalPages) {
                    currentPage++;
                    renderFamilyTable();
                }
            });

            // 全选
            document.getElementById('select-all').addEventListener('change', function() {
                const checkboxes = document.querySelectorAll('#family-table-body input[type="checkbox"]');
                checkboxes.forEach(cb => cb.checked = this.checked);
            });
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>